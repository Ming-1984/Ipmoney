openapi: 3.0.3
info:
  title: Ipmoney API
  version: 0.1.0
  license:
    name: Proprietary
    url: https://ipmoney.com
  description: |
    Ipmoney 专利交易平台（小程序 + 用户 H5 + 后台）对外 API（P0）。

    业务约束（P0）：
    - 标的范围：仅 CN 专利（数据以用户上传/后台录入为准）
    - 资金路径：订金与尾款均线上支付并托管
    - 合同签署：线下签署完成后由客服/运营确认里程碑解锁尾款支付
    - 佣金：卖家承担；放款时从卖家应收中扣除
servers:
  - url: https://api.ipmoney.com/v1
tags:
  - name: Auth
    description: 登录、短信验证码与 token
  - name: Users
    description: 用户资料与认证主体
  - name: Organizations
    description: 机构展示（企业/科研院校等）
  - name: Config
    description: 交易规则与推荐配置
  - name: Files
    description: 文件上传、下载与鉴权
  - name: Patents
    description: 专利主数据与号码规范化
  - name: Search
    description: 检索、排序与猜你喜欢
  - name: Listings
    description: 上架商品（卖家）与收藏/咨询
  - name: Demands
    description: 产学研需求（发布/审核/展示/咨询）
  - name: Achievements
    description: 成果展示（发布/审核/展示/咨询）
  - name: Artworks
    description: 书画专区（发布/审核/展示/咨询）
  - name: TechManagers
    description: 技术经理人栏目（检索/展示/咨询）
  - name: Orders
    description: 订单创建、查询与状态机
  - name: Payments
    description: 支付意图、回调与幂等
  - name: Refunds
    description: 退款申请与审批
  - name: Cases
    description: 跟单工单与里程碑
  - name: Invoices
    description: 订单电子发票下载
  - name: Messaging
    description: 会话与消息（咨询/聊天）
  - name: Comments
    description: 详情页留言与互动回复
  - name: Regions
    description: 行政区划与地域产业标签
  - name: PatentMap
    description: 专利地图数据查询
  - name: Admin
    description: 后台管理（审核/配置/财务/地图 CMS）
  - name: AI
    description: 智能体/语音/解析/评分（P1）
  - name: Maintenance
    description: 专利年费托管与工单（P1）
  - name: Alerts
    description: 告警与通知（P1）
security:
  - BearerAuth: []
paths:
  /auth/wechat/mp-login:
    post:
      tags: [Auth]
      summary: 微信小程序登录（code → token）
      description: |
        小程序端通过 `wx.login` 获取 `code` 后调用本接口。

        说明：
        - 服务端应使用微信 `code2Session`（`/sns/jscode2session`）换取 `openid/session_key`，并按 `openid` 做用户映射后签发平台 `accessToken`。
        - `wx.login` 不返回头像/昵称：头像/昵称建议走 `chooseAvatar + input type="nickname"`，并通过 `POST /files` + `PATCH /me` 落库。
      operationId: authWechatMpLogin
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code:
                  type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /auth/wechat/phone-bind:
    post:
      tags: [Auth]
      summary: WeChat phone bind (Mini Program)
      description: |
        Mini Program obtains `phoneCode` from `open-type="getPhoneNumber"` and calls this API to bind the phone.

        Notes:
        - Requires BearerAuth.
        - Real implementation should call WeChat `phonenumber.getPhoneNumber` and persist the phone to the user profile.
      operationId: authWechatPhoneBind
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [phoneCode]
              properties:
                phoneCode:
                  type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                required: [phone]
                properties:
                  phone:
                    $ref: "#/components/schemas/PhoneNumber"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /auth/sms/send:
    post:
      tags: [Auth]
      summary: 发送短信验证码
      operationId: authSmsSend
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [phone, purpose]
              properties:
                phone:
                  $ref: "#/components/schemas/PhoneNumber"
                purpose:
                  $ref: "#/components/schemas/SmsPurpose"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                required: [cooldownSeconds]
                properties:
                  cooldownSeconds:
                    type: integer
                    minimum: 0
        "400":
          $ref: "#/components/responses/BadRequest"

  /auth/sms/verify:
    post:
      tags: [Auth]
      summary: 短信验证码登录
      operationId: authSmsVerify
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [phone, code]
              properties:
                phone:
                  $ref: "#/components/schemas/PhoneNumber"
                code:
                  type: string
                  minLength: 4
                  maxLength: 8
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
  /me:
    get:
      tags: [Users]
      summary: 获取我的资料
      operationId: getMe
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfile"
        "401":
          $ref: "#/components/responses/Unauthorized"
    patch:
      tags: [Users]
      summary: 更新我的资料
      operationId: updateMe
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                  maxLength: 50
                  description: 昵称；小程序端建议使用 `<input type="nickname">` 采集
                avatarUrl:
                  type: string
                  format: uri
                  description: 头像 URL；建议先 `POST /files` 上传（`purpose=AVATAR`）再写入
                regionCode:
                  type: string
                  description: 用于地域推荐；小程序定位/手动选择后可更新
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfile"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /me/verification:
    get:
      tags: [Users]
      summary: 获取我的认证信息
      operationId: getMyVerification
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserVerification"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
    post:
      tags: [Users]
      summary: 提交认证
      operationId: submitMyVerification
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserVerificationSubmitRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserVerification"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"

  /me/favorites:
    get:
      tags: [Listings]
      summary: 我的收藏列表
      operationId: listMyFavoriteListings
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedListingSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /me/favorites/demands:
    get:
      tags: [Demands]
      summary: 我的需求收藏列表
      operationId: listMyFavoriteDemands
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedDemandSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /me/favorites/achievements:
    get:
      tags: [Achievements]
      summary: 我的成果收藏列表
      operationId: listMyFavoriteAchievements
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedAchievementSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /me/favorites/artworks:
    get:
      tags: [Artworks]
      summary: 我的书画收藏列表
      operationId: listMyFavoriteArtworks
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedArtworkSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /me/recommendations/listings:
    get:
      tags: [Search]
      summary: 猜你喜欢（个性化推荐）
      operationId: getMyRecommendedListings
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedListingSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /files:
    post:
      tags: [Files]
      summary: 上传文件
      description: |
        用于上传头像/认证材料/合同等文件。

        小程序头像建议：
        1) `purpose=AVATAR`
        2) 上传成功拿到 `url`
        3) `PATCH /me { avatarUrl: url }`
      operationId: uploadFile
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                purpose:
                  $ref: "#/components/schemas/FilePurpose"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FileObject"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /patents/normalize:
    post:
      tags: [Patents]
      summary: 专利号码解析与规范化
      operationId: normalizePatentNumber
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentNormalizeRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentNormalizeResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

  /patents/{patentId}:
    get:
      tags: [Patents]
      summary: 获取专利主数据
      operationId: getPatentById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/PatentId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Patent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/config/trade-rules:
    get:
      tags: [Config]
      summary: 获取交易规则配置（前台展示用）
      operationId: getPublicTradeRulesConfig
      security: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TradeRulesConfig"
        "400":
          $ref: "#/components/responses/BadRequest"

  /public/config/customer-service:
    get:
      tags: [Config]
      summary: 获取客服配置（前台展示用）
      operationId: getPublicCustomerServiceConfig
      security: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomerServiceConfig"
        "400":
          $ref: "#/components/responses/BadRequest"

  /public/listings/{listingId}:
    get:
      tags: [Listings]
      summary: 获取上架详情（公开）
      operationId: getPublicListingById
      security: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListingPublic"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/listings/{listingId}/comments:
    get:
      tags: [Comments]
      summary: 获取上架留言列表（公开）
      operationId: listPublicListingComments
      security: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedCommentThread"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/demands/{demandId}:
    get:
      tags: [Demands]
      summary: 获取需求详情（公开）
      operationId: getPublicDemandById
      security: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DemandPublic"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/demands/{demandId}/comments:
    get:
      tags: [Comments]
      summary: 获取需求留言列表（公开）
      operationId: listPublicDemandComments
      security: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedCommentThread"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/achievements/{achievementId}:
    get:
      tags: [Achievements]
      summary: 获取成果详情（公开）
      operationId: getPublicAchievementById
      security: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AchievementPublic"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/achievements/{achievementId}/comments:
    get:
      tags: [Comments]
      summary: 获取成果留言列表（公开）
      operationId: listPublicAchievementComments
      security: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedCommentThread"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/artworks/{artworkId}:
    get:
      tags: [Artworks]
      summary: 获取书画作品详情（公开）
      operationId: getPublicArtworkById
      security: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ArtworkPublic"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/artworks/{artworkId}/comments:
    get:
      tags: [Comments]
      summary: 获取书画留言列表（公开）
      operationId: listPublicArtworkComments
      security: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedCommentThread"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/tech-managers/{techManagerId}:
    get:
      tags: [TechManagers]
      summary: 获取技术经理人详情（公开）
      operationId: getPublicTechManagerById
      security: []
      parameters:
        - $ref: "#/components/parameters/TechManagerId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TechManagerPublic"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/organizations:
    get:
      tags: [Organizations]
      summary: 获取入驻机构列表（企业/科研院校等）
      operationId: listPublicOrganizations
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/OrganizationTypes"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedOrganizationSummary"
        "400":
          $ref: "#/components/responses/BadRequest"

  /public/industry-tags:
    get:
      tags: [Regions]
      summary: 获取产业标签列表（用于筛选）
      operationId: listPublicIndustryTags
      security: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/IndustryTag"
        "400":
          $ref: "#/components/responses/BadRequest"

  /public/organizations/{orgUserId}:
    get:
      tags: [Organizations]
      summary: 获取机构详情（公开）
      operationId: getPublicOrganizationById
      security: []
      parameters:
        - $ref: "#/components/parameters/OrgUserId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationSummary"
        "404":
          $ref: "#/components/responses/NotFound"

  /regions:
    get:
      tags: [Regions]
      summary: 获取行政区划树（用于筛选/地图）
      description: |-
        用于地区筛选与地图定位。

        小程序「专利地图」P0（最快落地）会用 `level=PROVINCE` 获取各省份的 `centerLat/centerLng` 作为地图 marker 坐标。
      operationId: listRegions
      security: []
      parameters:
        - name: level
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/RegionLevel"
        - name: parentCode
          in: query
          required: false
          schema:
            type: string
            pattern: "^[0-9]{6}$"
          description: 父级行政区划 adcode（6 位字符串）
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RegionNode"
        "400":
          $ref: "#/components/responses/BadRequest"

  /patent-map/years:
    get:
      tags: [PatentMap]
      summary: 获取地图可用年份列表
      operationId: listPatentMapYears
      security: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: integer
        "400":
          $ref: "#/components/responses/BadRequest"

  /patent-map/summary:
    get:
      tags: [PatentMap]
      summary: 获取地图热力数据（按区域聚合）
      description: |-
        返回某一年、某层级（省/市/区）的专利数量统计。

        小程序「专利地图」P0（最快落地）典型用法：
        1) `GET /patent-map/years` 获取年份；
        2) `GET /patent-map/summary?year=YYYY&level=PROVINCE` 获取省级专利数量；
        3) `GET /regions?level=PROVINCE` 获取省级中心点坐标，前端在真实地图上以 marker 展示。
      operationId: getPatentMapSummary
      security: []
      parameters:
        - name: year
          in: query
          required: true
          schema:
            type: integer
        - name: level
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/RegionLevel"
        - name: parentCode
          in: query
          required: false
          schema:
            type: string
          description: 父级行政区划码/adcode（如按 CITY 聚合时传省级 code）
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/PatentMapSummaryItem"
        "400":
          $ref: "#/components/responses/BadRequest"

  /patent-map/regions/{regionCode}:
    get:
      tags: [PatentMap]
      summary: 获取某区域地图详情（产业分布/重点企业）
      operationId: getPatentMapRegionDetail
      security: []
      parameters:
        - $ref: "#/components/parameters/RegionCodePath"
        - name: year
          in: query
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMapRegionDetail"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /search/listings:
    get:
      tags: [Search]
      summary: 专利交易检索
      operationId: searchListings
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/PatentType"
        - $ref: "#/components/parameters/Inventor"
        - $ref: "#/components/parameters/SellerUserId"
        - $ref: "#/components/parameters/TradeMode"
        - $ref: "#/components/parameters/PriceType"
        - $ref: "#/components/parameters/PriceMin"
        - $ref: "#/components/parameters/PriceMax"
        - $ref: "#/components/parameters/DepositMin"
        - $ref: "#/components/parameters/DepositMax"
        - $ref: "#/components/parameters/TransferCountMin"
        - $ref: "#/components/parameters/TransferCountMax"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/IndustryTags"
        - $ref: "#/components/parameters/Ipc"
        - $ref: "#/components/parameters/Loc"
        - $ref: "#/components/parameters/LegalStatus"
        - $ref: "#/components/parameters/SortBy"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedListingSummary"
        "400":
          $ref: "#/components/responses/BadRequest"

  /search/demands:
    get:
      tags: [Search]
      summary: 产学研需求检索
      operationId: searchDemands
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/IndustryTags"
        - $ref: "#/components/parameters/CooperationModes"
        - $ref: "#/components/parameters/BudgetType"
        - $ref: "#/components/parameters/BudgetMin"
        - $ref: "#/components/parameters/BudgetMax"
        - $ref: "#/components/parameters/ContentSortBy"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedDemandSummary"
        "400":
          $ref: "#/components/responses/BadRequest"

  /search/achievements:
    get:
      tags: [Search]
      summary: 成果展示检索
      operationId: searchAchievements
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/IndustryTags"
        - $ref: "#/components/parameters/CooperationModes"
        - $ref: "#/components/parameters/AchievementMaturity"
        - $ref: "#/components/parameters/ContentSortBy"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedAchievementSummary"
        "400":
          $ref: "#/components/responses/BadRequest"

  /search/artworks:
    get:
      tags: [Search]
      summary: 书画专区检索
      operationId: searchArtworks
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/ArtworkCategory"
        - $ref: "#/components/parameters/CalligraphyScript"
        - $ref: "#/components/parameters/PaintingGenre"
        - $ref: "#/components/parameters/Creator"
        - $ref: "#/components/parameters/CreationYearStart"
        - $ref: "#/components/parameters/CreationYearEnd"
        - $ref: "#/components/parameters/PriceType"
        - $ref: "#/components/parameters/PriceMin"
        - $ref: "#/components/parameters/PriceMax"
        - $ref: "#/components/parameters/DepositMin"
        - $ref: "#/components/parameters/DepositMax"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/ArtworkSortBy"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedArtworkSummary"
        "400":
          $ref: "#/components/responses/BadRequest"

  /search/tech-managers:
    get:
      tags: [Search, TechManagers]
      summary: 技术经理人检索
      operationId: searchTechManagers
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/TechManagerSortBy"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedTechManagerSummary"
        "400":
          $ref: "#/components/responses/BadRequest"

  /search/inventors:
    get:
      tags: [Search]
      summary: 发明人排行榜（按平台内上传专利统计）
      operationId: searchInventorRankings
      security: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/PatentType"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedInventorRanking"
        "400":
          $ref: "#/components/responses/BadRequest"

  /ai/agent/query:
    post:
      tags: [AI]
      summary: 智能体语义检索（P1）
      description: |
        支持文本/语音输入，输出结构化检索条件与匹配理由。
        小程序支持语音输入；H5 仅提示去小程序使用语音搜索。
      operationId: createAiAgentQuery
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AiAgentQueryRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AiAgentQueryResult"
        "400":
          $ref: "#/components/responses/BadRequest"

  /ai/parse-results/{parseResultId}/feedback:
    post:
      tags: [AI]
      summary: AI 解析评价/纠错反馈（P1）
      operationId: createAiParseFeedback
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ParseResultId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AiParseFeedbackRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AiParseFeedback"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /listings:
    post:
      tags: [Listings]
      summary: 创建上架草稿（卖家）
      operationId: createListing
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListingCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    get:
      tags: [Listings]
      summary: 我的上架列表（卖家）
      operationId: listMyListings
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingStatus"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedListing"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /listings/{listingId}:
    get:
      tags: [Listings]
      summary: 获取上架详情（卖家/已登录）
      operationId: getListingById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
    patch:
      tags: [Listings]
      summary: 更新上架草稿（卖家）
      operationId: updateListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListingUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /listings/{listingId}/favorites:
    post:
      tags: [Listings]
      summary: 收藏
      operationId: favoriteListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    delete:
      tags: [Listings]
      summary: 取消收藏
      operationId: unfavoriteListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /listings/{listingId}/consultations:
    post:
      tags: [Listings]
      summary: 记录咨询热度事件（用于推荐）
      operationId: createListingConsultation
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                channel:
                  type: string
                  enum: [WECHAT_CS, PHONE, FORM]
      responses:
        "204":
          description: No Content
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /listings/{listingId}/comments:
    post:
      tags: [Comments]
      summary: 创建上架留言/回复
      operationId: createListingComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /listings/{listingId}/submit:
    post:
      tags: [Listings]
      summary: 提交审核（卖家）
      operationId: submitListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /listings/{listingId}/off-shelf:
    post:
      tags: [Listings]
      summary: 下架（卖家）
      operationId: offShelfListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /demands:
    post:
      tags: [Demands]
      summary: 创建需求草稿（发布方）
      operationId: createDemand
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DemandCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    get:
      tags: [Demands]
      summary: 我的需求列表（发布方）
      operationId: listMyDemands
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ContentStatus"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedDemand"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /demands/{demandId}:
    get:
      tags: [Demands]
      summary: 获取需求详情（发布方/已登录）
      operationId: getDemandById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
    patch:
      tags: [Demands]
      summary: 更新需求草稿（发布方）
      operationId: updateDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DemandUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /demands/{demandId}/favorites:
    post:
      tags: [Demands]
      summary: 收藏需求
      operationId: favoriteDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    delete:
      tags: [Demands]
      summary: 取消收藏需求
      operationId: unfavoriteDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /demands/{demandId}/comments:
    post:
      tags: [Comments]
      summary: 创建需求留言/回复
      operationId: createDemandComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /demands/{demandId}/submit:
    post:
      tags: [Demands]
      summary: 提交审核（发布方）
      operationId: submitDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /demands/{demandId}/off-shelf:
    post:
      tags: [Demands]
      summary: 下架（发布方）
      operationId: offShelfDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /achievements:
    post:
      tags: [Achievements]
      summary: 创建成果草稿（发布方）
      operationId: createAchievement
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AchievementCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    get:
      tags: [Achievements]
      summary: 我的成果列表（发布方）
      operationId: listMyAchievements
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ContentStatus"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedAchievement"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /achievements/{achievementId}:
    get:
      tags: [Achievements]
      summary: 获取成果详情（发布方/已登录）
      operationId: getAchievementById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
    patch:
      tags: [Achievements]
      summary: 更新成果草稿（发布方）
      operationId: updateAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AchievementUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /achievements/{achievementId}/favorites:
    post:
      tags: [Achievements]
      summary: 收藏成果
      operationId: favoriteAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    delete:
      tags: [Achievements]
      summary: 取消收藏成果
      operationId: unfavoriteAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /achievements/{achievementId}/comments:
    post:
      tags: [Comments]
      summary: 创建成果留言/回复
      operationId: createAchievementComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /comments/{commentId}:
    patch:
      tags: [Comments]
      summary: 编辑留言
      operationId: updateComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/CommentId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    delete:
      tags: [Comments]
      summary: 删除留言
      operationId: deleteComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/CommentId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /achievements/{achievementId}/submit:
    post:
      tags: [Achievements]
      summary: 提交审核（发布方）
      operationId: submitAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /achievements/{achievementId}/off-shelf:
    post:
      tags: [Achievements]
      summary: 下架（发布方）
      operationId: offShelfAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /artworks:
    post:
      tags: [Artworks]
      summary: 创建书画草稿（发布方）
      operationId: createArtwork
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ArtworkCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    get:
      tags: [Artworks]
      summary: 我的书画列表（发布方）
      operationId: listMyArtworks
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkStatus"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedArtwork"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /artworks/{artworkId}:
    get:
      tags: [Artworks]
      summary: 获取书画详情（发布方/已登录）
      operationId: getArtworkById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
    patch:
      tags: [Artworks]
      summary: 更新书画草稿（发布方）
      operationId: updateArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ArtworkUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /artworks/{artworkId}/favorites:
    post:
      tags: [Artworks]
      summary: 收藏书画作品
      operationId: favoriteArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    delete:
      tags: [Artworks]
      summary: 取消收藏书画作品
      operationId: unfavoriteArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /artworks/{artworkId}/comments:
    post:
      tags: [Comments]
      summary: 创建书画留言/回复
      operationId: createArtworkComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CommentCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /artworks/{artworkId}/submit:
    post:
      tags: [Artworks]
      summary: 提交审核（发布方）
      operationId: submitArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /artworks/{artworkId}/off-shelf:
    post:
      tags: [Artworks]
      summary: 下架（发布方）
      operationId: offShelfArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /orders:
    post:
      tags: [Orders]
      summary: 创建订单（买家）
      operationId: createOrder
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              oneOf:
                - required: [listingId]
                - required: [artworkId]
              properties:
                listingId:
                  $ref: "#/components/schemas/Uuid"
                artworkId:
                  $ref: "#/components/schemas/Uuid"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    get:
      tags: [Orders]
      summary: 我的订单列表（买家/卖家）
      operationId: listMyOrders
      security:
        - BearerAuth: []
      parameters:
        - name: asRole
          in: query
          required: true
          schema:
            $ref: "#/components/schemas/OrderListRole"
        - $ref: "#/components/parameters/OrderStatus"
        - $ref: "#/components/parameters/OrderStatusGroup"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedOrder"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /orders/{orderId}:
    get:
      tags: [Orders]
      summary: 获取订单详情
      operationId: getOrderById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /orders/{orderId}/payment-intents:
    post:
      tags: [Payments]
      summary: 创建支付意图（订金/尾款）
      operationId: createPaymentIntent
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [payType]
              properties:
                payType:
                  $ref: "#/components/schemas/PayType"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentIntentResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"

  /orders/{orderId}/refund-requests:
    post:
      tags: [Refunds]
      summary: 发起退款申请
      operationId: createRefundRequest
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefundRequestCreate"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefundRequest"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    get:
      tags: [Refunds]
      summary: 查询退款申请列表
      operationId: listRefundRequestsByOrder
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RefundRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /orders/{orderId}/case:
    get:
      tags: [Cases]
      summary: 获取订单跟单工单与里程碑
      operationId: getOrderCase
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CaseWithMilestones"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /orders/{orderId}/invoice:
    get:
      tags: [Invoices]
      summary: 获取订单电子发票（订单完成后）
      operationId: getOrderInvoice
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderInvoice"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"

  /orders/{orderId}/invoice-requests:
    post:
      tags: [Invoices]
      summary: 发起开票申请（演示）
      description: |
        P0 口径：平台支持“财务线下开票 + 后台上传发票 PDF + 用户下载”。
        当前实现为演示用途，保留申请入口以便对齐前端流程与后续扩展。
      operationId: requestOrderInvoice
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvoiceRequestResult"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /invoices:
    get:
      tags: [Invoices]
      summary: 发票管理中心列表（演示）
      operationId: listMyInvoices
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/InvoiceStatus"
          description: 发票状态筛选
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedInvoiceItem"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /webhooks/wechatpay/notify:
    post:
      tags: [Payments]
      summary: 微信支付回调（内部接口）
      operationId: wechatPayNotify
      security: []
      description: |-
        微信支付 v3 回调统一入口（支付/退款）：服务端必须执行 **验签 + 解密 resource**，并做幂等处理（避免重复通知导致重复入账/重复退款）。
        参考：微信支付 v3 文档中的回调 HTTP Header（Wechatpay-*）与回调报文 resource 解密流程。
      parameters:
        - $ref: "#/components/parameters/WechatpayTimestamp"
        - $ref: "#/components/parameters/WechatpayNonce"
        - $ref: "#/components/parameters/WechatpaySignature"
        - $ref: "#/components/parameters/WechatpaySerial"
        - $ref: "#/components/parameters/WechatpaySignatureType"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        "204":
          description: No Content
        "400":
          $ref: "#/components/responses/BadRequest"

  /me/conversations:
    get:
      tags: [Messaging]
      summary: 获取我的会话列表
      operationId: listMyConversations
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedConversationSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /listings/{listingId}/conversations:
    post:
      tags: [Messaging]
      summary: 创建/获取与该上架相关的会话（咨询）
      operationId: upsertListingConversation
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /demands/{demandId}/conversations:
    post:
      tags: [Messaging]
      summary: 创建/获取与该需求相关的会话（咨询）
      operationId: upsertDemandConversation
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /achievements/{achievementId}/conversations:
    post:
      tags: [Messaging]
      summary: 创建/获取与该成果相关的会话（咨询）
      operationId: upsertAchievementConversation
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /artworks/{artworkId}/conversations:
    post:
      tags: [Messaging]
      summary: 创建/获取与该书画相关的会话（咨询）
      operationId: upsertArtworkConversation
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /tech-managers/{techManagerId}/conversations:
    post:
      tags: [Messaging, TechManagers]
      summary: 创建/获取与该技术经理人相关的会话（咨询）
      operationId: upsertTechManagerConversation
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/TechManagerId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /conversations/{conversationId}/messages:
    get:
      tags: [Messaging]
      summary: 获取会话消息列表
      operationId: listConversationMessages
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ConversationId"
        - name: cursor
          in: query
          required: false
          schema:
            type: string
          description: 游标分页（为空表示从最新开始）
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedConversationMessage"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
    post:
      tags: [Messaging]
      summary: 发送消息（文本/表情）
      operationId: sendConversationMessage
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ConversationId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ConversationMessageSendRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ConversationMessage"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /conversations/{conversationId}/read:
    post:
      tags: [Messaging]
      summary: 标记会话已读
      operationId: markConversationRead
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ConversationId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/regions:
    get:
      tags: [Admin, Regions]
      summary: 区域管理：查询区域列表
      operationId: adminListRegions
      security:
        - BearerAuth: []
      parameters:
        - name: level
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/RegionLevel"
        - name: parentCode
          in: query
          required: false
          schema:
            type: string
        - name: q
          in: query
          required: false
          schema:
            type: string
          description: 名称/拼音模糊搜索
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RegionNode"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin, Regions]
      summary: 区域管理：新增区域节点
      operationId: adminCreateRegion
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegionCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegionNode"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/regions/{regionCode}:
    patch:
      tags: [Admin, Regions]
      summary: 区域管理：更新区域节点
      operationId: adminUpdateRegion
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RegionCodePath"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegionUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegionNode"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/regions/{regionCode}/industry-tags:
    put:
      tags: [Admin, Regions]
      summary: 区域管理：设置区域特色产业标签
      operationId: adminSetRegionIndustryTags
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RegionCodePath"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [industryTags]
              properties:
                industryTags:
                  type: array
                  items:
                    type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegionNode"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/industry-tags:
    get:
      tags: [Admin, Regions]
      summary: 获取可用产业标签列表
      operationId: adminListIndustryTags
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/IndustryTag"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin, Regions]
      summary: 新增产业标签
      operationId: adminCreateIndustryTag
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/IndustryTagCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IndustryTag"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/patent-map/regions/{regionCode}/years/{year}:
    get:
      tags: [Admin, PatentMap]
      summary: 查看区域+年份地图数据
      operationId: adminGetPatentMapEntry
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RegionCodePath"
        - $ref: "#/components/parameters/YearPath"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMapEntry"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      tags: [Admin, PatentMap]
      summary: 录入/更新区域+年份地图数据
      operationId: adminUpsertPatentMapEntry
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RegionCodePath"
        - $ref: "#/components/parameters/YearPath"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentMapEntryUpsertRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMapEntry"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/patent-map/import:
    post:
      tags: [Admin, PatentMap]
      summary: Excel 导入地图数据
      operationId: adminImportPatentMapExcel
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                dryRun:
                  type: boolean
                  default: false
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMapImportResult"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/config/trade-rules:
    get:
      tags: [Admin, Config]
      summary: 获取交易规则配置（后台）
      operationId: adminGetTradeRulesConfig
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TradeRulesConfig"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/config/customer-service:
    get:
      tags: [Admin, Config]
      summary: 获取客服配置（后台）
      operationId: adminGetCustomerServiceConfig
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomerServiceConfig"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    put:
      tags: [Admin, Config]
      summary: 更新客服配置（后台）
      operationId: adminUpdateCustomerServiceConfig
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CustomerServiceConfigUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomerServiceConfig"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /contracts:
    get:
      tags: [Contracts]
      summary: 合同中心列表
      description: |
        合同文件仅支持 PDF。
        - 仅卖家可上传合同（`POST /contracts/{contractId}/upload`）
        - 买家可查阅并确认（确认能力 P1；P0 以“待确认/可查阅”状态演示为准）
      operationId: listContracts
      security:
        - BearerAuth: []
      parameters:
        - name: status
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/ContractStatus"
          description: 合同状态筛选
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedContract"
        "401":
          $ref: "#/components/responses/Unauthorized"

  /contracts/{contractId}/upload:
    post:
      tags: [Contracts]
      summary: 卖家上传合同（PDF）
      description: |
        流程：
        1) `POST /files` 上传 PDF（`purpose=CONTRACT_EVIDENCE`）
        2) 拿到 `file.id`
        3) 调用本接口把 `contractFileId` 关联到合同记录
      operationId: uploadContractPdf
      security:
        - BearerAuth: []
      parameters:
        - name: contractId
          in: path
          required: true
          schema:
            type: string
          description: 合同 ID（当前实现为 `contract-{orderId}`）
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ContractUploadRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ContractItem"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "403":
          $ref: "#/components/responses/Forbidden"
    put:
      tags: [Admin, Config]
      summary: 更新交易规则配置（后台）
      operationId: adminUpdateTradeRulesConfig
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TradeRulesConfigUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TradeRulesConfig"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/config/recommendation:
    get:
      tags: [Admin, Config]
      summary: 获取推荐配置（后台）
      operationId: adminGetRecommendationConfig
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RecommendationConfig"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    put:
      tags: [Admin, Config]
      summary: 更新推荐配置（后台）
      operationId: adminUpdateRecommendationConfig
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RecommendationConfigUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RecommendationConfig"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/config/ai:
    get:
      tags: [Admin, Config, AI]
      summary: 获取 AI 配置（后台，P1）
      operationId: adminGetAiConfig
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AiConfig"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    put:
      tags: [Admin, Config, AI]
      summary: 更新 AI 配置（后台，P1）
      operationId: adminUpdateAiConfig
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AiConfigUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AiConfig"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/config/alerts:
    get:
      tags: [Admin, Config, Alerts]
      summary: 获取告警配置（后台，P1）
      operationId: adminGetAlertConfig
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlertConfig"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    put:
      tags: [Admin, Config, Alerts]
      summary: 更新告警配置（后台，P1）
      operationId: adminUpdateAlertConfig
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AlertConfigUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlertConfig"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/ai/parse-results:
    get:
      tags: [Admin, AI]
      summary: AI 解析复核列表（P1）
      operationId: adminListAiParseResults
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AiContentType"
        - $ref: "#/components/parameters/AiParseStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedAiParseResult"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/ai/parse-results/{parseResultId}:
    get:
      tags: [Admin, AI]
      summary: 获取 AI 解析详情（P1）
      operationId: adminGetAiParseResult
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ParseResultId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AiParseResult"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin, AI]
      summary: 更新 AI 解析结果（P1）
      operationId: adminUpdateAiParseResult
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ParseResultId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AiParseResultUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AiParseResult"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/patents:
    get:
      tags: [Admin, Patents]
      summary: 专利库列表（后台，P1）
      operationId: adminListPatents
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/PatentType"
        - $ref: "#/components/parameters/LegalStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedPatent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin, Patents]
      summary: 新建专利主数据（后台，P1）
      operationId: adminCreatePatent
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Patent"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/patents/{patentId}:
    get:
      tags: [Admin, Patents]
      summary: 获取专利主数据（后台，P1）
      operationId: adminGetPatentById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/PatentId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Patent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin, Patents]
      summary: 更新专利主数据（后台，P1）
      operationId: adminUpdatePatent
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/PatentId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Patent"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/patent-maintenance/schedules:
    get:
      tags: [Admin, Maintenance]
      summary: 年费日程列表（后台，P1）
      operationId: adminListPatentMaintenanceSchedules
      security:
        - BearerAuth: []
      parameters:
        - name: patentId
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/Uuid"
        - $ref: "#/components/parameters/MaintenanceStatus"
        - name: dueFrom
          in: query
          required: false
          schema:
            type: string
            format: date
        - name: dueTo
          in: query
          required: false
          schema:
            type: string
            format: date
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedPatentMaintenanceSchedule"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin, Maintenance]
      summary: 创建年费日程（后台，P1）
      operationId: adminCreatePatentMaintenanceSchedule
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentMaintenanceScheduleCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMaintenanceSchedule"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/patent-maintenance/schedules/{scheduleId}:
    get:
      tags: [Admin, Maintenance]
      summary: 获取年费日程详情（后台，P1）
      operationId: adminGetPatentMaintenanceSchedule
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MaintenanceScheduleId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMaintenanceSchedule"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin, Maintenance]
      summary: 更新年费日程（后台，P1）
      operationId: adminUpdatePatentMaintenanceSchedule
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MaintenanceScheduleId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentMaintenanceScheduleUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMaintenanceSchedule"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/patent-maintenance/tasks:
    get:
      tags: [Admin, Maintenance]
      summary: 托管任务列表（后台，P1）
      operationId: adminListPatentMaintenanceTasks
      security:
        - BearerAuth: []
      parameters:
        - name: scheduleId
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/Uuid"
        - name: assignedCsUserId
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/Uuid"
        - $ref: "#/components/parameters/MaintenanceTaskStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedPatentMaintenanceTask"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin, Maintenance]
      summary: 创建托管任务（后台，P1）
      operationId: adminCreatePatentMaintenanceTask
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentMaintenanceTaskCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMaintenanceTask"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/patent-maintenance/tasks/{taskId}:
    patch:
      tags: [Admin, Maintenance]
      summary: 更新托管任务（后台，P1）
      operationId: adminUpdatePatentMaintenanceTask
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MaintenanceTaskId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PatentMaintenanceTaskUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PatentMaintenanceTask"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/alerts:
    get:
      tags: [Admin, Alerts]
      summary: 告警事件列表（后台，P1）
      operationId: adminListAlertEvents
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AlertStatus"
        - $ref: "#/components/parameters/AlertSeverity"
        - $ref: "#/components/parameters/AlertChannel"
        - $ref: "#/components/parameters/AlertTargetType"
        - name: type
          in: query
          required: false
          schema:
            type: string
        - name: targetId
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/Uuid"
        - name: triggeredFrom
          in: query
          required: false
          schema:
            type: string
            format: date-time
        - name: triggeredTo
          in: query
          required: false
          schema:
            type: string
            format: date-time
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedAlertEvent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/alerts/{alertId}/ack:
    post:
      tags: [Admin, Alerts]
      summary: 告警确认（后台，P1）
      operationId: adminAcknowledgeAlertEvent
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AlertId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlertEvent"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/listings:
    get:
      tags: [Admin]
      summary: 上架审核/平台内容列表
      operationId: adminListListingsForAudit
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/ListingStatus"
        - $ref: "#/components/parameters/ContentSource"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedListing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin]
      summary: 创建平台自有上架（P1）
      operationId: adminCreateListing
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminListingCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/listings/{listingId}:
    get:
      tags: [Admin]
      summary: 获取上架详情（后台，P1）
      operationId: adminGetListingById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin]
      summary: 更新平台自有上架（后台，P1）
      operationId: adminUpdateListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminListingUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/listings/{listingId}/publish:
    post:
      tags: [Admin]
      summary: 发布上架（后台，P1）
      operationId: adminPublishListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/listings/{listingId}/off-shelf:
    post:
      tags: [Admin]
      summary: 下架（后台，P1）
      operationId: adminOffShelfListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/listings/{listingId}/approve:
    post:
      tags: [Admin]
      summary: 上架审核通过
      operationId: adminApproveListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/listings/{listingId}/reject:
    post:
      tags: [Admin]
      summary: 上架审核驳回
      operationId: adminRejectListing
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  minLength: 1
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/listings/{listingId}/featured:
    put:
      tags: [Admin]
      summary: 标记省/市级特色产业专利（置顶/加权）
      operationId: adminSetListingFeatured
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ListingId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ListingFeaturedUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Listing"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/demands:
    get:
      tags: [Admin]
      summary: 需求审核/平台内容列表
      operationId: adminListDemandsForAudit
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/ContentStatus"
        - $ref: "#/components/parameters/ContentSource"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedDemand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin]
      summary: 创建平台自有需求（P1）
      operationId: adminCreateDemand
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminDemandCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/demands/{demandId}:
    get:
      tags: [Admin]
      summary: 获取需求详情（后台，P1）
      operationId: adminGetDemandById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin]
      summary: 更新平台自有需求（后台，P1）
      operationId: adminUpdateDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminDemandUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/demands/{demandId}/publish:
    post:
      tags: [Admin]
      summary: 发布需求（后台，P1）
      operationId: adminPublishDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/demands/{demandId}/off-shelf:
    post:
      tags: [Admin]
      summary: 下架需求（后台，P1）
      operationId: adminOffShelfDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/demands/{demandId}/approve:
    post:
      tags: [Admin]
      summary: 需求审核通过
      operationId: adminApproveDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/demands/{demandId}/reject:
    post:
      tags: [Admin]
      summary: 需求审核驳回
      operationId: adminRejectDemand
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/DemandId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  minLength: 1
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Demand"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/achievements:
    get:
      tags: [Admin]
      summary: 成果审核/平台内容列表
      operationId: adminListAchievementsForAudit
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/ContentStatus"
        - $ref: "#/components/parameters/ContentSource"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedAchievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin]
      summary: 创建平台自有成果（P1）
      operationId: adminCreateAchievement
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminAchievementCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/achievements/{achievementId}:
    get:
      tags: [Admin]
      summary: 获取成果详情（后台，P1）
      operationId: adminGetAchievementById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin]
      summary: 更新平台自有成果（后台，P1）
      operationId: adminUpdateAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminAchievementUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/achievements/{achievementId}/publish:
    post:
      tags: [Admin]
      summary: 发布成果（后台，P1）
      operationId: adminPublishAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/achievements/{achievementId}/off-shelf:
    post:
      tags: [Admin]
      summary: 下架成果（后台，P1）
      operationId: adminOffShelfAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/achievements/{achievementId}/approve:
    post:
      tags: [Admin]
      summary: 成果审核通过
      operationId: adminApproveAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/achievements/{achievementId}/reject:
    post:
      tags: [Admin]
      summary: 成果审核驳回
      operationId: adminRejectAchievement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/AchievementId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  minLength: 1
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Achievement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/artworks:
    get:
      tags: [Admin]
      summary: 书画审核/平台内容列表
      operationId: adminListArtworksForAudit
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/AuditStatus"
        - $ref: "#/components/parameters/ArtworkStatus"
        - $ref: "#/components/parameters/ContentSource"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedArtwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
    post:
      tags: [Admin]
      summary: 创建平台自有书画（P1）
      operationId: adminCreateArtwork
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminArtworkCreateRequest"
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/artworks/{artworkId}:
    get:
      tags: [Admin]
      summary: 获取书画详情（后台，P1）
      operationId: adminGetArtworkById
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags: [Admin]
      summary: 更新平台自有书画（后台，P1）
      operationId: adminUpdateArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminArtworkUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/artworks/{artworkId}/publish:
    post:
      tags: [Admin]
      summary: 发布书画（后台，P1）
      operationId: adminPublishArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/artworks/{artworkId}/off-shelf:
    post:
      tags: [Admin]
      summary: 下架书画（后台，P1）
      operationId: adminOffShelfArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  maxLength: 200
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/artworks/{artworkId}/approve:
    post:
      tags: [Admin]
      summary: 书画审核通过
      operationId: adminApproveArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/artworks/{artworkId}/reject:
    post:
      tags: [Admin]
      summary: 书画审核驳回
      operationId: adminRejectArtwork
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/ArtworkId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  minLength: 1
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Artwork"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/tech-managers:
    get:
      tags: [Admin, TechManagers]
      summary: 技术经理人管理列表
      operationId: adminListTechManagers
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/RegionCode"
        - $ref: "#/components/parameters/VerificationStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedTechManagerSummary"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/tech-managers/{techManagerId}:
    patch:
      tags: [Admin, TechManagers]
      summary: 更新技术经理人展示信息
      operationId: adminUpdateTechManager
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/TechManagerId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TechManagerUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TechManagerPublic"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/comments:
    get:
      tags: [Admin]
      summary: 留言管理列表
      operationId: adminListComments
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/Q"
        - $ref: "#/components/parameters/CommentContentType"
        - $ref: "#/components/parameters/CommentContentId"
        - $ref: "#/components/parameters/CommentStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedComment"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/comments/{commentId}:
    patch:
      tags: [Admin]
      summary: 更新留言状态（隐藏/恢复/删除）
      operationId: adminUpdateComment
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/CommentId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AdminCommentUpdateRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Comment"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/user-verifications:
    get:
      tags: [Admin]
      summary: 认证审核列表
      operationId: adminListUserVerifications
      security:
        - BearerAuth: []
      parameters:
        - name: q
          in: query
          required: false
          schema:
            type: string
          description: 按主体名称/手机号模糊搜索
        - name: type
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/VerificationType"
        - name: status
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/VerificationStatus"
        - $ref: "#/components/parameters/Page"
        - $ref: "#/components/parameters/PageSize"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedUserVerification"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/user-verifications/{verificationId}/approve:
    post:
      tags: [Admin]
      summary: 认证通过
      operationId: adminApproveUserVerification
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/VerificationId"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                comment:
                  type: string
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserVerification"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/user-verifications/{verificationId}/reject:
    post:
      tags: [Admin]
      summary: 认证驳回
      operationId: adminRejectUserVerification
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/VerificationId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  minLength: 1
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserVerification"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/orders/{orderId}/milestones/contract-signed:
    post:
      tags: [Admin]
      summary: 合同签署确认（解锁尾款支付）
      operationId: adminConfirmContractSigned
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [dealAmountFen]
              properties:
                dealAmountFen:
                  $ref: "#/components/schemas/MoneyFen"
                evidenceFileId:
                  $ref: "#/components/schemas/Uuid"
                signedAt:
                  type: string
                  format: date-time
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/orders/{orderId}/milestones/transfer-completed:
    post:
      tags: [Admin]
      summary: 变更完成确认（触发结算放款）
      operationId: adminConfirmTransferCompleted
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                evidenceFileId:
                  $ref: "#/components/schemas/Uuid"
                completedAt:
                  type: string
                  format: date-time
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/orders/{orderId}/settlement:
    get:
      tags: [Admin]
      summary: 查看结算台账
      operationId: adminGetOrderSettlement
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Settlement"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/orders/{orderId}/payouts/manual:
    post:
      tags: [Admin]
      summary: 财务人工放款确认（P0 默认）
      operationId: adminConfirmManualPayout
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ManualPayoutConfirmRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Settlement"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/orders/{orderId}/invoice:
    put:
      tags: [Admin]
      summary: 上传/替换订单电子发票（财务）
      operationId: adminUpsertOrderInvoice
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OrderInvoiceUpsertRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderInvoice"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
    delete:
      tags: [Admin]
      summary: 删除订单电子发票（财务）
      operationId: adminDeleteOrderInvoice
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrderId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "204":
          description: No Content
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/refund-requests/{refundRequestId}/approve:
    post:
      tags: [Admin]
      summary: 退款审批通过
      operationId: adminApproveRefundRequest
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RefundRequestId"
        - $ref: "#/components/parameters/IdempotencyKey"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefundRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

  /admin/refund-requests/{refundRequestId}/reject:
    post:
      tags: [Admin]
      summary: 退款审批驳回
      operationId: adminRejectRefundRequest
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/RefundRequestId"
        - $ref: "#/components/parameters/IdempotencyKey"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason:
                  type: string
                  minLength: 1
                  maxLength: 500
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RefundRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    NotFound:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
  parameters:
    Q:
      name: q
      in: query
      required: false
      schema:
        type: string
      description: 关键词（标题/摘要/权利人/发明人/机构名称等）
    PatentType:
      name: patentType
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/PatentType"
    TradeMode:
      name: tradeMode
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/TradeMode"
    PriceType:
      name: priceType
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/PriceType"
    PriceMin:
      name: priceMinFen
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/MoneyFen"
    PriceMax:
      name: priceMaxFen
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/MoneyFen"
    BudgetType:
      name: budgetType
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/PriceType"
    BudgetMin:
      name: budgetMinFen
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/MoneyFen"
    BudgetMax:
      name: budgetMaxFen
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/MoneyFen"
    DepositMin:
      name: depositMinFen
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/MoneyFen"
    DepositMax:
      name: depositMaxFen
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/MoneyFen"
    TransferCountMin:
      name: transferCountMin
      in: query
      required: false
      schema:
        type: integer
        minimum: 0
    TransferCountMax:
      name: transferCountMax
      in: query
      required: false
      schema:
        type: integer
        minimum: 0
    RegionCode:
      name: regionCode
      in: query
      required: false
      schema:
        type: string
        pattern: "^[0-9]{6}$"
        example: "110000"
      description: 行政区划 adcode（6 位字符串）

    ArtworkCategory:
      name: category
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ArtworkCategory"
      description: 书画类别（书法/绘画）

    CalligraphyScript:
      name: calligraphyScript
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/CalligraphyScript"

    PaintingGenre:
      name: paintingGenre
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/PaintingGenre"

    Creator:
      name: creator
      in: query
      required: false
      schema:
        type: string
      description: 作者/创作者

    CreationYearStart:
      name: creationYearStart
      in: query
      required: false
      schema:
        type: integer
        minimum: 0
      description: 创作年份起

    CreationYearEnd:
      name: creationYearEnd
      in: query
      required: false
      schema:
        type: integer
        minimum: 0
      description: 创作年份止

    OrganizationTypes:
      name: types
      in: query
      required: false
      schema:
        type: array
        items:
          $ref: "#/components/schemas/VerificationType"
      style: form
      explode: true
      description: 机构类型过滤（默认仅展示已审核通过的企业/科研院校）

    Inventor:
      name: inventor
      in: query
      required: false
      schema:
        type: string
      description: 发明人姓名（精确/模糊匹配，取决于实现；用于聚合其相关专利）

    SellerUserId:
      name: sellerUserId
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/Uuid"
      description: 卖家/机构 userId（用于机构聚合页筛选）
    IndustryTags:
      name: industryTags
      in: query
      required: false
      schema:
        type: array
        items:
          type: string
      style: form
      explode: true
      description: 产业标签过滤（可多选）
    Ipc:
      name: ipc
      in: query
      required: false
      schema:
        type: string
      description: IPC 分类号（前缀匹配，如 H04L）
    Loc:
      name: loc
      in: query
      required: false
      schema:
        type: string
      description: Locarno 分类号（如 14-02）
    LegalStatus:
      name: legalStatus
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/LegalStatus"
    SortBy:
      name: sortBy
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/SortBy"
    ContentSortBy:
      name: sortBy
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ContentSortBy"
    ArtworkSortBy:
      name: sortBy
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ArtworkSortBy"
    TechManagerSortBy:
      name: sortBy
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/TechManagerSortBy"
    CooperationModes:
      name: cooperationModes
      in: query
      required: false
      schema:
        type: array
        items:
          $ref: "#/components/schemas/CooperationMode"
      style: form
      explode: true
      description: 合作方式过滤（可多选）
    AchievementMaturity:
      name: maturity
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AchievementMaturity"
    ContentStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ContentStatus"
    ArtworkStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ArtworkStatus"

    ContentSource:
      name: source
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ContentSource"
      description: 内容来源过滤

    VerificationStatus:
      name: verificationStatus
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/VerificationStatus"
      description: 认证状态过滤

    AiContentType:
      name: contentType
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AiContentType"
      description: AI 内容类型过滤

    AiParseStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AiParseStatus"
      description: AI 解析状态过滤

    MaintenanceStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/PatentMaintenanceStatus"
      description: 年费日程状态过滤

    MaintenanceTaskStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/PatentMaintenanceTaskStatus"
      description: 托管任务状态过滤

    AlertStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AlertStatus"
      description: 告警状态过滤

    AlertSeverity:
      name: severity
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AlertSeverity"
      description: 告警级别过滤

    AlertChannel:
      name: channel
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AlertChannel"
      description: 告警渠道过滤

    AlertTargetType:
      name: targetType
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AlertTargetType"
      description: 告警目标类型过滤

    ParseResultId:
      name: parseResultId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    MaintenanceScheduleId:
      name: scheduleId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    MaintenanceTaskId:
      name: taskId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    AlertId:
      name: alertId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    CommentContentType:
      name: contentType
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/CommentContentType"
      description: 留言所属内容类型过滤

    CommentContentId:
      name: contentId
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/Uuid"
      description: 留言所属内容 ID 过滤

    CommentStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/CommentStatus"
      description: 留言状态过滤（后台管理）

    Page:
      name: page
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        default: 1
    PageSize:
      name: pageSize
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20
    ListingStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/ListingStatus"
    AuditStatus:
      name: auditStatus
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/AuditStatus"
    OrderStatus:
      name: status
      in: query
      required: false
      schema:
        $ref: "#/components/schemas/OrderStatus"

    OrderStatusGroup:
      name: statusGroup
      in: query
      required: false
      description: "订单状态分组筛选（用于“全部/待付款/进行中/退款/售后/已结束”等聚合 Tab）"
      schema:
        $ref: "#/components/schemas/OrderStatusGroup"

    IdempotencyKey:
      name: Idempotency-Key
      in: header
      required: false
      schema:
        type: string
        maxLength: 64
      description: 幂等键（建议用于支付/退款/放款等有副作用的接口；同一幂等键的重复请求应返回同一结果）

    WechatpayTimestamp:
      name: Wechatpay-Timestamp
      in: header
      required: true
      schema:
        type: string
      description: 微信支付回调验签字段（v3）：时间戳字符串
    WechatpayNonce:
      name: Wechatpay-Nonce
      in: header
      required: true
      schema:
        type: string
      description: 微信支付回调验签字段（v3）：随机串
    WechatpaySignature:
      name: Wechatpay-Signature
      in: header
      required: true
      schema:
        type: string
      description: 微信支付回调验签字段（v3）：签名
    WechatpaySerial:
      name: Wechatpay-Serial
      in: header
      required: true
      schema:
        type: string
      description: 微信支付回调验签字段（v3）：平台证书序列号
    WechatpaySignatureType:
      name: Wechatpay-Signature-Type
      in: header
      required: false
      schema:
        type: string
      description: 微信支付回调验签字段（v3）：签名类型（如 WECHATPAY2-SHA256-RSA2048）

    ListingId:
      name: listingId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    DemandId:
      name: demandId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    AchievementId:
      name: achievementId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    ArtworkId:
      name: artworkId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    TechManagerId:
      name: techManagerId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    CommentId:
      name: commentId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    OrgUserId:
      name: orgUserId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    ConversationId:
      name: conversationId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"

    RegionCodePath:
      name: regionCode
      in: path
      required: true
      schema:
        type: string
      description: 行政区划码/adcode

    YearPath:
      name: year
      in: path
      required: true
      schema:
        type: integer
    OrderId:
      name: orderId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"
    RefundRequestId:
      name: refundRequestId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"
    PatentId:
      name: patentId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"
    VerificationId:
      name: verificationId
      in: path
      required: true
      schema:
        $ref: "#/components/schemas/Uuid"
  schemas:
    Uuid:
      type: string
      format: uuid
    PhoneNumber:
      type: string
      example: "13800138000"
    MoneyFen:
      type: integer
      format: int64
      minimum: 0
      description: 金额（人民币分）

    ErrorResponse:
      type: object
      required: [code, message]
      properties:
        code:
          type: string
        message:
          type: string
        details:
          type: object
          additionalProperties: true

    SmsPurpose:
      type: string
      enum: [LOGIN, BIND_PHONE]

    UserRole:
      type: string
      enum: [buyer, seller, cs, admin]

    VerificationType:
      type: string
      enum: [PERSON, COMPANY, ACADEMY, GOVERNMENT, ASSOCIATION, TECH_MANAGER]

    SupplyType:
      type: string
      enum: [UNIVERSITY, UNIVERSITY_985, UNIVERSITY_211, RESEARCH_INSTITUTE, OTHER]

    VerificationStatus:
      type: string
      enum: [PENDING, APPROVED, REJECTED]

    FilePurpose:
      type: string
      enum:
        - AVATAR
        - ORG_LOGO
        - IDENTITY
        - BUSINESS_LICENSE
        - ORG_CERTIFICATE
        - PROFESSIONAL_CERTIFICATE
        - PATENT_PROOF
        - CONTRACT_EVIDENCE
        - INVOICE
        - OTHER

    ContractStatus:
      type: string
      enum: [WAIT_UPLOAD, WAIT_CONFIRM, AVAILABLE]
      description: 合同中心状态（卖家上传 PDF → 买家确认 → 可查阅）

    ContractUploadRequest:
      type: object
      description: |
        合同上传请求（仅卖家可调用）。
        `contractFileId` 建议来自 `POST /files`（`purpose=CONTRACT_EVIDENCE`），且仅允许 PDF。
      properties:
        contractFileId:
          $ref: "#/components/schemas/Uuid"

    ContractItem:
      type: object
      required: [id, orderId, status, createdAt]
      properties:
        id:
          type: string
          description: 合同 ID（当前实现为 `contract-{orderId}`）
        orderId:
          $ref: "#/components/schemas/Uuid"
        listingTitle:
          type: string
          nullable: true
        counterpartName:
          type: string
          nullable: true
        status:
          $ref: "#/components/schemas/ContractStatus"
        createdAt:
          type: string
          format: date-time
        uploadedAt:
          type: string
          format: date-time
          nullable: true
        signedAt:
          type: string
          format: date-time
          nullable: true
        fileUrl:
          type: string
          format: uri
          nullable: true
          description: 合同 PDF URL（演示用；生产建议关联 FileObject）
        watermarkOwner:
          type: string
          nullable: true
          description: 水印/归属标识（演示用）
        canUpload:
          type: boolean
          description: 是否允许上传（仅卖家为 true）

    PagedContract:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/ContractItem"
        page:
          $ref: "#/components/schemas/PageMeta"

    InvoiceStatus:
      type: string
      enum: [WAIT_APPLY, APPLYING, ISSUED]
      description: 发票状态（演示；真实生产需按财务流程细化）

    InvoiceRequestResult:
      type: object
      required: [orderId, status]
      properties:
        orderId:
          $ref: "#/components/schemas/Uuid"
        status:
          $ref: "#/components/schemas/InvoiceStatus"

    InvoiceItem:
      allOf:
        - $ref: "#/components/schemas/Order"
        - type: object
          required: [invoiceStatus]
          properties:
            invoiceStatus:
              $ref: "#/components/schemas/InvoiceStatus"
            amountFen:
              $ref: "#/components/schemas/MoneyFen"
              nullable: true
            itemName:
              type: string
              nullable: true
            invoiceNo:
              type: string
              nullable: true
            issuedAt:
              type: string
              format: date-time
              nullable: true
            invoiceFileUrl:
              type: string
              format: uri
              nullable: true
            requestedAt:
              type: string
              format: date-time
              nullable: true

    PagedInvoiceItem:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/InvoiceItem"
        page:
          $ref: "#/components/schemas/PageMeta"

    UserProfile:
      type: object
      required: [id, role, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        phone:
          $ref: "#/components/schemas/PhoneNumber"
          nullable: true
          description: 手机号（可选；未绑定手机号的微信用户可能为空）
        nickname:
          type: string
        avatarUrl:
          type: string
          format: uri
        role:
          $ref: "#/components/schemas/UserRole"
        verificationStatus:
          $ref: "#/components/schemas/VerificationStatus"
        verificationType:
          $ref: "#/components/schemas/VerificationType"
          nullable: true
        orgCategory:
          $ref: "#/components/schemas/SupplyType"
        orgCategory:
          $ref: "#/components/schemas/SupplyType"
          description: 用户选择的身份类型（未选择/未提交时为空）
        regionCode:
          type: string
          description: 用户当前地区（用于地域推荐；可由小程序定位/手动选择后更新）
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    AuthTokenResponse:
      type: object
      required: [accessToken, expiresInSeconds, user]
      properties:
        accessToken:
          type: string
        refreshToken:
          type: string
        expiresInSeconds:
          type: integer
          minimum: 1
        user:
          $ref: "#/components/schemas/UserProfile"

    UserVerification:
      type: object
      required: [id, userId, type, status, submittedAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        userId:
          $ref: "#/components/schemas/Uuid"
        type:
          $ref: "#/components/schemas/VerificationType"
        status:
          $ref: "#/components/schemas/VerificationStatus"
        displayName:
          type: string
        unifiedSocialCreditCodeMasked:
          type: string
          description: 企业/机构统一社会信用代码（脱敏）
        contactName:
          type: string
        contactPhoneMasked:
          type: string
        idNumberMasked:
          type: string
          description: 个人身份证号/技术经理人证件号（脱敏）
        regionCode:
          type: string
          description: 主体所在地区（用于展示/地域推荐）
        intro:
          type: string
          description: 主体简介（用于机构展示）
        serviceTags:
          type: array
          items:
            type: string
          description: 技术经理人服务标签（仅 TECH_MANAGER）
        logoFileId:
          $ref: "#/components/schemas/Uuid"
        logoUrl:
          type: string
          format: uri
        evidenceFileIds:
          type: array
          items:
            $ref: "#/components/schemas/Uuid"
        submittedAt:
          type: string
          format: date-time
        reviewedAt:
          type: string
          format: date-time
        reviewComment:
          type: string

    UserVerificationSubmitRequest:
      oneOf:
        - $ref: "#/components/schemas/UserVerificationSubmitPersonRequest"
        - $ref: "#/components/schemas/UserVerificationSubmitOrganizationRequest"
        - $ref: "#/components/schemas/UserVerificationSubmitTechManagerRequest"
      discriminator:
        propertyName: type
        mapping:
          PERSON: "#/components/schemas/UserVerificationSubmitPersonRequest"
          COMPANY: "#/components/schemas/UserVerificationSubmitOrganizationRequest"
          ACADEMY: "#/components/schemas/UserVerificationSubmitOrganizationRequest"
          GOVERNMENT: "#/components/schemas/UserVerificationSubmitOrganizationRequest"
          ASSOCIATION: "#/components/schemas/UserVerificationSubmitOrganizationRequest"
          TECH_MANAGER: "#/components/schemas/UserVerificationSubmitTechManagerRequest"

    UserVerificationSubmitPersonRequest:
      type: object
      required: [type, displayName]
      properties:
        type:
          type: string
          enum: [PERSON]
        displayName:
          type: string
          minLength: 1
          maxLength: 200
          description: 个人展示名称（可默认取昵称）
        idNumber:
          type: string
          description: 可选；如采集则后台存储需加密

    UserVerificationSubmitOrganizationRequest:
      type: object
      required: [type, displayName, evidenceFileIds]
      properties:
        type:
          type: string
          enum: [COMPANY, ACADEMY, GOVERNMENT, ASSOCIATION]
        displayName:
          type: string
          minLength: 1
          maxLength: 200
          description: 主体名称（企业/科研院校/政府/协会）
        unifiedSocialCreditCode:
          type: string
          description: 统一社会信用代码（后台需加密/脱敏展示）
        contactName:
          type: string
        contactPhone:
          $ref: "#/components/schemas/PhoneNumber"
        regionCode:
          type: string
        intro:
          type: string
          maxLength: 2000
        logoFileId:
          $ref: "#/components/schemas/Uuid"
        evidenceFileIds:
          type: array
          minItems: 1
          items:
            $ref: "#/components/schemas/Uuid"

    UserVerificationSubmitTechManagerRequest:
      type: object
      required: [type, displayName, evidenceFileIds]
      properties:
        type:
          type: string
          enum: [TECH_MANAGER]
        displayName:
          type: string
          minLength: 1
          maxLength: 200
          description: 技术经理人/经纪人展示名称
        idNumber:
          type: string
          description: 可选；如采集则后台存储需加密
        contactPhone:
          $ref: "#/components/schemas/PhoneNumber"
        regionCode:
          type: string
        intro:
          type: string
          maxLength: 2000
        serviceTags:
          type: array
          items:
            type: string
            maxLength: 50
        evidenceFileIds:
          type: array
          minItems: 1
          items:
            $ref: "#/components/schemas/Uuid"

    FileObject:
      type: object
      required: [id, url, mimeType, sizeBytes, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        url:
          type: string
          format: uri
        mimeType:
          type: string
        sizeBytes:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time

    Jurisdiction:
      type: string
      enum: [CN]

    PatentType:
      type: string
      enum: [INVENTION, UTILITY_MODEL, DESIGN]

    PatentNumberInputType:
      type: string
      enum: [APPLICATION_NO, PATENT_NO, PUBLICATION_NO]

    PatentNormalizeRequest:
      type: object
      required: [raw]
      properties:
        raw:
          type: string

    PatentNormalizeResponse:
      type: object
      required: [jurisdiction, inputType]
      properties:
        jurisdiction:
          $ref: "#/components/schemas/Jurisdiction"
        inputType:
          $ref: "#/components/schemas/PatentNumberInputType"
        applicationNoNorm:
          type: string
          example: "2023113409720"
        applicationNoDisplay:
          type: string
          example: "202311340972.0"
        publicationNoNorm:
          type: string
          example: "CN116123456A"
        publicationNoDisplay:
          type: string
          example: "CN116123456A"
        patentNoNorm:
          type: string
          example: "ZL2023113409720"
        patentNoDisplay:
          type: string
          example: "ZL202311340972.0"
        kindCode:
          type: string
          example: "A"
        patentType:
          $ref: "#/components/schemas/PatentType"
        warnings:
          type: array
          items:
            type: string

    LegalStatus:
      type: string
      enum: [PENDING, GRANTED, EXPIRED, INVALIDATED, UNKNOWN]

    Patent:
      type: object
      required: [id, jurisdiction, applicationNoNorm, patentType, title, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        jurisdiction:
          $ref: "#/components/schemas/Jurisdiction"
        applicationNoNorm:
          type: string
        applicationNoDisplay:
          type: string
        patentNoDisplay:
          type: string
        publicationNoDisplay:
          type: string
        grantPublicationNoDisplay:
          type: string
        patentType:
          $ref: "#/components/schemas/PatentType"
        title:
          type: string
        abstract:
          type: string
        caseStatus:
          type: string
        mainIpcCode:
          type: string
        claimCount:
          type: integer
          minimum: 0
        specPageCount:
          type: integer
          minimum: 0
        specWordCount:
          type: integer
          minimum: 0
        specFigureCount:
          type: integer
          minimum: 0
        inventorNames:
          type: array
          items:
            type: string
        assigneeNames:
          type: array
          items:
            type: string
        applicantNames:
          type: array
          items:
            type: string
        filingDate:
          type: string
          format: date
        publicationDate:
          type: string
          format: date
        grantDate:
          type: string
          format: date
        legalStatus:
          $ref: "#/components/schemas/LegalStatus"
        sourcePrimary:
          type: string
          enum: [USER, ADMIN, PROVIDER]
        sourceUpdatedAt:
          type: string
          format: date-time
        media:
          type: array
          items:
            $ref: "#/components/schemas/PatentMedia"
        tradeSnapshot:
          $ref: "#/components/schemas/PatentTradeSnapshot"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PatentMedia:
      type: object
      required: [fileId, type, sort]
      properties:
        fileId:
          $ref: "#/components/schemas/Uuid"
        url:
          type: string
          format: uri
        type:
          type: string
          enum: [COVER, SPEC_FIGURE]
        sort:
          type: integer
          minimum: 0

    PatentTradeSnapshot:
      type: object
      properties:
        listingId:
          $ref: "#/components/schemas/Uuid"
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          type: integer
          minimum: 0
        depositAmountFen:
          type: integer
          minimum: 0
        seller:
          $ref: "#/components/schemas/UserBrief"
        supplyType:
          $ref: "#/components/schemas/SupplyType"

    TradeMode:
      type: string
      enum: [ASSIGNMENT, LICENSE]

    LicenseMode:
      type: string
      enum: [EXCLUSIVE, SOLE, NON_EXCLUSIVE]

    PriceType:
      type: string
      enum: [FIXED, NEGOTIABLE]

    AuditStatus:
      type: string
      enum: [PENDING, APPROVED, REJECTED]

    ContentSource:
      type: string
      enum: [USER, PLATFORM, ADMIN]

    ListingStatus:
      type: string
      enum: [DRAFT, ACTIVE, OFF_SHELF, SOLD]

    SortBy:
      type: string
      enum: [RECOMMENDED, NEWEST, PRICE_ASC, PRICE_DESC]

    FeaturedLevel:
      type: string
      enum: [NONE, CITY, PROVINCE]

    ListingStats:
      type: object
      required: [viewCount, favoriteCount, consultCount]
      properties:
        viewCount:
          type: integer
          format: int64
          minimum: 0
        favoriteCount:
          type: integer
          format: int64
          minimum: 0
        consultCount:
          type: integer
          format: int64
          minimum: 0
        commentCount:
          type: integer
          format: int64
          minimum: 0

    ListingMedia:
      type: object
      required: [fileId, type, sort]
      properties:
        fileId:
          $ref: "#/components/schemas/Uuid"
        type:
          type: string
          enum: [IMAGE, FILE]
        sort:
          type: integer
          minimum: 0

    ListingSummary:
      type: object
      required: [id, title, tradeMode, priceType, depositAmountFen, auditStatus, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        patentId:
          $ref: "#/components/schemas/Uuid"
        source:
          $ref: "#/components/schemas/ContentSource"
        applicationNoDisplay:
          type: string
        patentType:
          $ref: "#/components/schemas/PatentType"
        title:
          type: string
        inventorNames:
          type: array
          items:
            type: string
          description: 发明人列表（用于展示/发明人榜跳转；P0 可选返回）
        tradeMode:
          $ref: "#/components/schemas/TradeMode"
        licenseMode:
          $ref: "#/components/schemas/LicenseMode"
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        featuredLevel:
          $ref: "#/components/schemas/FeaturedLevel"
        featuredRegionCode:
          type: string
          description: 省/市级特色产业专利的生效区域（adcode）
        featuredRank:
          type: integer
          minimum: 0
          description: 特色置顶优先级（数值越小越靠前）
        featuredUntil:
          type: string
          format: date-time
          description: 特色置顶过期时间（为空表示长期）
        stats:
          $ref: "#/components/schemas/ListingStats"
        transferCount:
          type: integer
          minimum: 0
          description: 转让次数（0 表示沉睡专利）
        recommendationScore:
          type: number
          format: double
          description: 智能推荐得分（仅在 sortBy=RECOMMENDED 或猜你喜欢接口中返回）
        auditStatus:
          $ref: "#/components/schemas/AuditStatus"
        status:
          $ref: "#/components/schemas/ListingStatus"
        coverUrl:
          type: string
          format: uri
        createdAt:
          type: string
          format: date-time

    Listing:
      allOf:
        - $ref: "#/components/schemas/ListingSummary"
        - type: object
          properties:
            sellerUserId:
              $ref: "#/components/schemas/Uuid"
            summary:
              type: string
            ipcCodes:
              type: array
              items:
                type: string
            locCodes:
              type: array
              items:
                type: string
            media:
              type: array
              items:
                $ref: "#/components/schemas/ListingMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true
            proofFileIds:
              type: array
              items:
                $ref: "#/components/schemas/Uuid"

    ListingPublic:
      allOf:
        - $ref: "#/components/schemas/ListingSummary"
        - type: object
          properties:
            seller:
              $ref: "#/components/schemas/UserBrief"
            summary:
              type: string
            ipcCodes:
              type: array
              items:
                type: string
            locCodes:
              type: array
              items:
                type: string
            media:
              type: array
              items:
                $ref: "#/components/schemas/ListingMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true

    ListingCreateRequest:
      type: object
      required: [patentNumberRaw, tradeMode, priceType]
      properties:
        patentNumberRaw:
          type: string
        patentType:
          $ref: "#/components/schemas/PatentType"
          description: 若无法自动识别则必填
        title:
          type: string
          maxLength: 200
        inventorNames:
          type: array
          items:
            type: string
          description: 发明人（用于发明人榜；P0 建议填写）
        assigneeNames:
          type: array
          items:
            type: string
          description: 权利人/专利权人（用于检索与展示；P0 建议填写）
        applicantNames:
          type: array
          items:
            type: string
          description: 申请人（可选）
        summary:
          type: string
          maxLength: 2000
        tradeMode:
          $ref: "#/components/schemas/TradeMode"
        licenseMode:
          $ref: "#/components/schemas/LicenseMode"
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          $ref: "#/components/schemas/MoneyFen"
          description: FIXED 时必填
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
          description: 可选；若不填则按平台订金策略计算
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        ipcCodes:
          type: array
          items:
            type: string
        locCodes:
          type: array
          items:
            type: string
        media:
          type: array
          items:
            $ref: "#/components/schemas/ListingMedia"
        proofFileIds:
          type: array
          items:
            $ref: "#/components/schemas/Uuid"

    ListingUpdateRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 200
        inventorNames:
          type: array
          items:
            type: string
        assigneeNames:
          type: array
          items:
            type: string
        applicantNames:
          type: array
          items:
            type: string
        summary:
          type: string
          maxLength: 2000
        tradeMode:
          $ref: "#/components/schemas/TradeMode"
        licenseMode:
          $ref: "#/components/schemas/LicenseMode"
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        ipcCodes:
          type: array
          items:
            type: string
        locCodes:
          type: array
          items:
            type: string
        media:
          type: array
          items:
            $ref: "#/components/schemas/ListingMedia"
        proofFileIds:
          type: array
          items:
            $ref: "#/components/schemas/Uuid"

    ListingFeaturedUpdateRequest:
      type: object
      required: [featuredLevel]
      properties:
        featuredLevel:
          $ref: "#/components/schemas/FeaturedLevel"
        featuredRegionCode:
          type: string
          description: 省/市级生效区域 adcode（featuredLevel != NONE 时必填）
        featuredRank:
          type: integer
          minimum: 0
          description: 特色置顶优先级（数值越小越靠前）
        featuredUntil:
          type: string
          format: date-time
          description: 过期时间（为空表示长期）

    PageMeta:
      type: object
      required: [page, pageSize, total]
      properties:
        page:
          type: integer
          minimum: 1
        pageSize:
          type: integer
          minimum: 1
        total:
          type: integer
          minimum: 0

    PagedListingSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/ListingSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    PagedListing:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Listing"
        page:
          $ref: "#/components/schemas/PageMeta"

    ContentStatus:
      type: string
      enum: [DRAFT, ACTIVE, OFF_SHELF]

    ContentSortBy:
      type: string
      enum: [RECOMMENDED, NEWEST]

    ArtworkSortBy:
      type: string
      enum: [RECOMMENDED, NEWEST, PRICE_ASC, PRICE_DESC]

    TechManagerSortBy:
      type: string
      enum: [RECOMMENDED, NEWEST]

    ArtworkCategory:
      type: string
      enum: [CALLIGRAPHY, PAINTING]

    CalligraphyScript:
      type: string
      enum: [KAISHU, XINGSHU, CAOSHU, LISHU, ZHUANSHU]

    PaintingGenre:
      type: string
      enum: [FIGURE, LANDSCAPE, BIRD_FLOWER, OTHER]

    ArtworkStatus:
      type: string
      enum: [DRAFT, ACTIVE, OFF_SHELF, SOLD]

    CooperationMode:
      type: string
      enum: [TRANSFER, TECH_CONSULTING, COMMISSIONED_DEV, PLATFORM_CO_BUILD]

    AchievementMaturity:
      type: string
      enum: [CONCEPT, PROTOTYPE, PILOT, MASS_PRODUCTION, COMMERCIALIZED, OTHER]

    DeliveryPeriod:
      type: string
      enum: [WITHIN_1_MONTH, MONTH_1_3, MONTH_3_6, OVER_6_MONTHS, OTHER]

    ContentMedia:
      type: object
      required: [fileId, type, sort]
      properties:
        fileId:
          $ref: "#/components/schemas/Uuid"
        type:
          type: string
          enum: [IMAGE, VIDEO, FILE]
        sort:
          type: integer
          minimum: 0
        url:
          type: string
          format: uri
          readOnly: true
        mimeType:
          type: string
          readOnly: true
        sizeBytes:
          type: integer
          format: int64
          readOnly: true
        fileName:
          type: string
          readOnly: true

    DemandSummary:
      type: object
      required: [id, title, publisher, auditStatus, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        source:
          $ref: "#/components/schemas/ContentSource"
        title:
          type: string
          maxLength: 200
        summary:
          type: string
          maxLength: 2000
        budgetType:
          $ref: "#/components/schemas/PriceType"
        budgetMinFen:
          $ref: "#/components/schemas/MoneyFen"
        budgetMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        keywords:
          type: array
          maxItems: 30
          items:
            type: string
            maxLength: 50
        deliveryPeriod:
          $ref: "#/components/schemas/DeliveryPeriod"
        publisher:
          $ref: "#/components/schemas/OrganizationSummary"
        stats:
          $ref: "#/components/schemas/ListingStats"
        auditStatus:
          $ref: "#/components/schemas/AuditStatus"
        status:
          $ref: "#/components/schemas/ContentStatus"
        coverUrl:
          type: string
          format: uri
        createdAt:
          type: string
          format: date-time

    Demand:
      allOf:
        - $ref: "#/components/schemas/DemandSummary"
        - type: object
          properties:
            publisherUserId:
              $ref: "#/components/schemas/Uuid"
            description:
              type: string
              maxLength: 2000
            keywords:
              type: array
              maxItems: 30
              items:
                type: string
                maxLength: 50
            deliveryPeriod:
              $ref: "#/components/schemas/DeliveryPeriod"
            contactName:
              type: string
              maxLength: 50
            contactTitle:
              type: string
              maxLength: 100
            contactPhoneMasked:
              type: string
              maxLength: 30
            coverFileId:
              $ref: "#/components/schemas/Uuid"
              nullable: true
            media:
              type: array
              items:
                $ref: "#/components/schemas/ContentMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true
            updatedAt:
              type: string
              format: date-time

    DemandPublic:
      allOf:
        - $ref: "#/components/schemas/DemandSummary"
        - type: object
          properties:
            description:
              type: string
              maxLength: 2000
            media:
              type: array
              items:
                $ref: "#/components/schemas/ContentMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true

    PagedDemandSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/DemandSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    PagedDemand:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Demand"
        page:
          $ref: "#/components/schemas/PageMeta"

    DemandCreateRequest:
      type: object
      required: [title]
      properties:
        title:
          type: string
          maxLength: 200
        description:
          type: string
          maxLength: 2000
        summary:
          type: string
          maxLength: 2000
        keywords:
          type: array
          maxItems: 30
          items:
            type: string
            maxLength: 50
        deliveryPeriod:
          $ref: "#/components/schemas/DeliveryPeriod"
        budgetType:
          $ref: "#/components/schemas/PriceType"
        budgetMinFen:
          $ref: "#/components/schemas/MoneyFen"
        budgetMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        contactName:
          type: string
          maxLength: 50
        contactTitle:
          type: string
          maxLength: 100
        contactPhoneMasked:
          type: string
          maxLength: 30
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        coverFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        media:
          type: array
          items:
            $ref: "#/components/schemas/ContentMedia"

    DemandUpdateRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 200
        description:
          type: string
          maxLength: 2000
        summary:
          type: string
          maxLength: 2000
        keywords:
          type: array
          maxItems: 30
          items:
            type: string
            maxLength: 50
        deliveryPeriod:
          $ref: "#/components/schemas/DeliveryPeriod"
        budgetType:
          $ref: "#/components/schemas/PriceType"
        budgetMinFen:
          $ref: "#/components/schemas/MoneyFen"
        budgetMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        contactName:
          type: string
          maxLength: 50
        contactTitle:
          type: string
          maxLength: 100
        contactPhoneMasked:
          type: string
          maxLength: 30
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        coverFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        media:
          type: array
          items:
            $ref: "#/components/schemas/ContentMedia"

    AchievementSummary:
      type: object
      required: [id, title, publisher, auditStatus, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        source:
          $ref: "#/components/schemas/ContentSource"
        title:
          type: string
          maxLength: 200
        summary:
          type: string
          maxLength: 2000
        maturity:
          $ref: "#/components/schemas/AchievementMaturity"
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        keywords:
          type: array
          maxItems: 30
          items:
            type: string
            maxLength: 50
        publisher:
          $ref: "#/components/schemas/OrganizationSummary"
        stats:
          $ref: "#/components/schemas/ListingStats"
        auditStatus:
          $ref: "#/components/schemas/AuditStatus"
        status:
          $ref: "#/components/schemas/ContentStatus"
        coverUrl:
          type: string
          format: uri
        createdAt:
          type: string
          format: date-time

    Achievement:
      allOf:
        - $ref: "#/components/schemas/AchievementSummary"
        - type: object
          properties:
            publisherUserId:
              $ref: "#/components/schemas/Uuid"
            description:
              type: string
              maxLength: 5000
            coverFileId:
              $ref: "#/components/schemas/Uuid"
              nullable: true
            media:
              type: array
              items:
                $ref: "#/components/schemas/ContentMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true
            updatedAt:
              type: string
              format: date-time

    AchievementPublic:
      allOf:
        - $ref: "#/components/schemas/AchievementSummary"
        - type: object
          properties:
            description:
              type: string
              maxLength: 5000
            media:
              type: array
              items:
                $ref: "#/components/schemas/ContentMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true

    PagedAchievementSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/AchievementSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    PagedAchievement:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Achievement"
        page:
          $ref: "#/components/schemas/PageMeta"

    AchievementCreateRequest:
      type: object
      required: [title]
      properties:
        title:
          type: string
          maxLength: 200
        description:
          type: string
          maxLength: 5000
        summary:
          type: string
          maxLength: 2000
        keywords:
          type: array
          maxItems: 30
          items:
            type: string
            maxLength: 50
        maturity:
          $ref: "#/components/schemas/AchievementMaturity"
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        coverFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        media:
          type: array
          items:
            $ref: "#/components/schemas/ContentMedia"

    AchievementUpdateRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 200
        description:
          type: string
          maxLength: 5000
        summary:
          type: string
          maxLength: 2000
        keywords:
          type: array
          maxItems: 30
          items:
            type: string
            maxLength: 50
        maturity:
          $ref: "#/components/schemas/AchievementMaturity"
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        coverFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        media:
          type: array
          items:
            $ref: "#/components/schemas/ContentMedia"

    ArtworkSummary:
      type: object
      required: [id, title, category, creatorName, priceType, depositAmountFen, auditStatus, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        source:
          $ref: "#/components/schemas/ContentSource"
        title:
          type: string
          maxLength: 200
        category:
          $ref: "#/components/schemas/ArtworkCategory"
        calligraphyScript:
          $ref: "#/components/schemas/CalligraphyScript"
        paintingGenre:
          $ref: "#/components/schemas/PaintingGenre"
        creatorName:
          type: string
          maxLength: 200
        creationDate:
          type: string
          format: date
        creationYear:
          type: integer
          minimum: 0
        certificateNo:
          type: string
          maxLength: 100
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        regionCode:
          type: string
        material:
          type: string
          maxLength: 200
        size:
          type: string
          maxLength: 100
        coverUrl:
          type: string
          format: uri
        stats:
          $ref: "#/components/schemas/ListingStats"
        auditStatus:
          $ref: "#/components/schemas/AuditStatus"
        status:
          $ref: "#/components/schemas/ArtworkStatus"
        createdAt:
          type: string
          format: date-time

    Artwork:
      allOf:
        - $ref: "#/components/schemas/ArtworkSummary"
        - type: object
          properties:
            sellerUserId:
              $ref: "#/components/schemas/Uuid"
            description:
              type: string
              maxLength: 5000
            certificateFileIds:
              type: array
              items:
                $ref: "#/components/schemas/Uuid"
            coverFileId:
              $ref: "#/components/schemas/Uuid"
              nullable: true
            media:
              type: array
              items:
                $ref: "#/components/schemas/ContentMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true
            updatedAt:
              type: string
              format: date-time

    ArtworkPublic:
      allOf:
        - $ref: "#/components/schemas/ArtworkSummary"
        - type: object
          properties:
            seller:
              $ref: "#/components/schemas/UserBrief"
            description:
              type: string
              maxLength: 5000
            media:
              type: array
              items:
                $ref: "#/components/schemas/ContentMedia"
            aiParse:
              $ref: "#/components/schemas/AiParseResult"
              nullable: true

    PagedArtworkSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/ArtworkSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    PagedArtwork:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Artwork"
        page:
          $ref: "#/components/schemas/PageMeta"

    ArtworkCreateRequest:
      type: object
      required: [title, category, creatorName, priceType]
      properties:
        title:
          type: string
          maxLength: 200
        category:
          $ref: "#/components/schemas/ArtworkCategory"
        calligraphyScript:
          $ref: "#/components/schemas/CalligraphyScript"
        paintingGenre:
          $ref: "#/components/schemas/PaintingGenre"
        creatorName:
          type: string
          maxLength: 200
        creationDate:
          type: string
          format: date
        creationYear:
          type: integer
          minimum: 0
        certificateNo:
          type: string
          maxLength: 100
        certificateFileIds:
          type: array
          items:
            $ref: "#/components/schemas/Uuid"
        description:
          type: string
          maxLength: 5000
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        regionCode:
          type: string
        material:
          type: string
          maxLength: 200
        size:
          type: string
          maxLength: 100
        coverFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        media:
          type: array
          items:
            $ref: "#/components/schemas/ContentMedia"

    ArtworkUpdateRequest:
      type: object
      properties:
        title:
          type: string
          maxLength: 200
        category:
          $ref: "#/components/schemas/ArtworkCategory"
        calligraphyScript:
          $ref: "#/components/schemas/CalligraphyScript"
        paintingGenre:
          $ref: "#/components/schemas/PaintingGenre"
        creatorName:
          type: string
          maxLength: 200
        creationDate:
          type: string
          format: date
        creationYear:
          type: integer
          minimum: 0
        certificateNo:
          type: string
          maxLength: 100
        certificateFileIds:
          type: array
          items:
            $ref: "#/components/schemas/Uuid"
        description:
          type: string
          maxLength: 5000
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        regionCode:
          type: string
        material:
          type: string
          maxLength: 200
        size:
          type: string
          maxLength: 100
        coverFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        media:
          type: array
          items:
            $ref: "#/components/schemas/ContentMedia"

    OrganizationStats:
      type: object
      required: [listingCount, patentCount]
      properties:
        listingCount:
          type: integer
          minimum: 0
        patentCount:
          type: integer
          minimum: 0

    OrganizationSummary:
      type: object
      required: [userId, displayName, verificationType, verificationStatus]
      properties:
        userId:
          $ref: "#/components/schemas/Uuid"
        displayName:
          type: string
        verificationType:
          $ref: "#/components/schemas/VerificationType"
        verificationStatus:
          $ref: "#/components/schemas/VerificationStatus"
        orgCategory:
          $ref: "#/components/schemas/SupplyType"
        regionCode:
          type: string
        logoUrl:
          type: string
          format: uri
        intro:
          type: string
        stats:
          $ref: "#/components/schemas/OrganizationStats"
        verifiedAt:
          type: string
          format: date-time

    PagedOrganizationSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/OrganizationSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    TechManagerStats:
      type: object
      properties:
        consultCount:
          type: integer
          minimum: 0
        dealCount:
          type: integer
          minimum: 0
        ratingScore:
          type: number
          format: double
          minimum: 0
          maximum: 5
        ratingCount:
          type: integer
          minimum: 0

    TechManagerSummary:
      type: object
      required: [userId, displayName, verificationType, verificationStatus]
      properties:
        userId:
          $ref: "#/components/schemas/Uuid"
        displayName:
          type: string
        verificationType:
          $ref: "#/components/schemas/VerificationType"
        verificationStatus:
          $ref: "#/components/schemas/VerificationStatus"
        regionCode:
          type: string
        avatarUrl:
          type: string
          format: uri
        intro:
          type: string
        serviceTags:
          type: array
          items:
            type: string
        stats:
          $ref: "#/components/schemas/TechManagerStats"
        verifiedAt:
          type: string
          format: date-time

    TechManagerPublic:
      allOf:
        - $ref: "#/components/schemas/TechManagerSummary"
        - type: object
          properties:
            evidenceFileIds:
              type: array
              items:
                $ref: "#/components/schemas/Uuid"

    PagedTechManagerSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/TechManagerSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    TechManagerUpdateRequest:
      type: object
      properties:
        intro:
          type: string
          maxLength: 2000
        serviceTags:
          type: array
          items:
            type: string
            maxLength: 50
        featuredRank:
          type: integer
          minimum: 0
        featuredUntil:
          type: string
          format: date-time

    InventorRankingItem:
      type: object
      required: [inventorName, patentCount, listingCount]
      properties:
        inventorName:
          type: string
        patentCount:
          type: integer
          minimum: 0
          description: 该发明人在平台内上传专利中的去重数量（按 patentId）
        listingCount:
          type: integer
          minimum: 0
          description: 关联到的上架数量（可用于参考）

    PagedInventorRanking:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/InventorRankingItem"
        page:
          $ref: "#/components/schemas/PageMeta"

    OrderStatus:
      type: string
      enum:
        - DEPOSIT_PENDING
        - DEPOSIT_PAID
        - WAIT_FINAL_PAYMENT
        - FINAL_PAID_ESCROW
        - READY_TO_SETTLE
        - COMPLETED
        - CANCELLED
        - REFUNDING
        - REFUNDED

    OrderStatusGroup:
      type: string
      description: 订单状态分组（用于列表页聚合 Tab 筛选）
      enum:
        - PAYMENT_PENDING
        - IN_PROGRESS
        - REFUND
        - DONE

    OrderListRole:
      type: string
      enum: [BUYER, SELLER]

    Order:
      type: object
      required: [id, buyerUserId, status, depositAmountFen, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        listingId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        artworkId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        patentId:
          $ref: "#/components/schemas/Uuid"
        buyerUserId:
          $ref: "#/components/schemas/Uuid"
        sellerUserId:
          $ref: "#/components/schemas/Uuid"
        assignedCsUserId:
          $ref: "#/components/schemas/Uuid"
        status:
          $ref: "#/components/schemas/OrderStatus"
        dealAmountFen:
          $ref: "#/components/schemas/MoneyFen"
          description: 合同签署确认后写入（成交总价）
        depositAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        finalAmountFen:
          $ref: "#/components/schemas/MoneyFen"
          description: 合同签署确认后写入（尾款金额）
        commissionAmountFen:
          $ref: "#/components/schemas/MoneyFen"
          description: 结算时写入（卖家承担）
        invoice:
          $ref: "#/components/schemas/OrderInvoice"
          description: 订单电子发票（仅订单完成后可能存在）
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PayType:
      type: string
      enum: [DEPOSIT, FINAL]

    PaymentIntentResponse:
      type: object
      required: [paymentId, payType, channel, amountFen, wechatPayParams]
      properties:
        paymentId:
          $ref: "#/components/schemas/Uuid"
        payType:
          $ref: "#/components/schemas/PayType"
        channel:
          type: string
          enum: [WECHAT]
        amountFen:
          $ref: "#/components/schemas/MoneyFen"
        wechatPayParams:
          type: object
          required: [timeStamp, nonceStr, package, signType, paySign]
          properties:
            timeStamp:
              type: string
            nonceStr:
              type: string
            package:
              type: string
            signType:
              type: string
            paySign:
              type: string
 
    PayoutMethod:
      type: string
      enum: [MANUAL, WECHAT]
 
    PayoutStatus:
      type: string
      enum: [PENDING, SUCCEEDED, FAILED]
 
    Settlement:
      type: object
      required:
        - id
        - orderId
        - grossAmountFen
        - commissionAmountFen
        - payoutAmountFen
        - payoutMethod
        - payoutStatus
        - createdAt
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        orderId:
          $ref: "#/components/schemas/Uuid"
        grossAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        commissionAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        payoutAmountFen:
          $ref: "#/components/schemas/MoneyFen"
        payoutMethod:
          $ref: "#/components/schemas/PayoutMethod"
        payoutStatus:
          $ref: "#/components/schemas/PayoutStatus"
        payoutRef:
          type: string
          maxLength: 100
        payoutEvidenceFileId:
          $ref: "#/components/schemas/Uuid"
        payoutAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    OrderInvoiceUpsertRequest:
      type: object
      required: [invoiceFileId]
      properties:
        invoiceFileId:
          $ref: "#/components/schemas/Uuid"
        invoiceNo:
          type: string
          maxLength: 50
        issuedAt:
          type: string
          format: date-time

    OrderInvoice:
      type: object
      required: [orderId, invoiceFile]
      properties:
        orderId:
          $ref: "#/components/schemas/Uuid"
        amountFen:
          $ref: "#/components/schemas/MoneyFen"
          description: 订单服务费/佣金金额（开票金额）
        itemName:
          type: string
          description: 发票项目名称/服务内容（默认：居间服务费）
        invoiceNo:
          type: string
        issuedAt:
          type: string
          format: date-time
        invoiceFile:
          $ref: "#/components/schemas/FileObject"
        attachedAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
 
    ManualPayoutConfirmRequest:
      type: object
      required: [payoutEvidenceFileId]
      properties:
        payoutRef:
          type: string
          maxLength: 100
        payoutEvidenceFileId:
          $ref: "#/components/schemas/Uuid"
        payoutAt:
          type: string
          format: date-time
        remark:
          type: string
          maxLength: 500
 
    PagedOrder:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Order"
        page:
          $ref: "#/components/schemas/PageMeta"

    RefundRequestStatus:
      type: string
      enum: [PENDING, APPROVED, REJECTED, REFUNDING, REFUNDED]

    RefundReasonCode:
      type: string
      enum: [BUYER_CHANGED_MIND, SELLER_MISSING_MATERIALS, MUTUAL_AGREEMENT, RISK_CONTROL, OTHER]

    RefundRequestCreate:
      type: object
      required: [reasonCode]
      properties:
        reasonCode:
          $ref: "#/components/schemas/RefundReasonCode"
        reasonText:
          type: string
          maxLength: 500
        evidenceFileIds:
          type: array
          items:
            $ref: "#/components/schemas/Uuid"

    RefundRequest:
      type: object
      required: [id, orderId, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        orderId:
          $ref: "#/components/schemas/Uuid"
        reasonCode:
          $ref: "#/components/schemas/RefundReasonCode"
        reasonText:
          type: string
        status:
          $ref: "#/components/schemas/RefundRequestStatus"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CaseType:
      type: string
      enum: [FOLLOWUP, REFUND, DISPUTE]

    CaseStatus:
      type: string
      enum: [OPEN, IN_PROGRESS, CLOSED]

    MilestoneName:
      type: string
      enum: [CONTRACT_SIGNED, TRANSFER_SUBMITTED, TRANSFER_COMPLETED]

    MilestoneStatus:
      type: string
      enum: [PENDING, DONE]

    Milestone:
      type: object
      required: [name, status]
      properties:
        name:
          $ref: "#/components/schemas/MilestoneName"
        status:
          $ref: "#/components/schemas/MilestoneStatus"
        evidenceFileId:
          $ref: "#/components/schemas/Uuid"
        occurredAt:
          type: string
          format: date-time

    CaseWithMilestones:
      type: object
      required: [caseId, orderId, type, status, milestones]
      properties:
        caseId:
          $ref: "#/components/schemas/Uuid"
        orderId:
          $ref: "#/components/schemas/Uuid"
        type:
          $ref: "#/components/schemas/CaseType"
        status:
          $ref: "#/components/schemas/CaseStatus"
        csUserId:
          $ref: "#/components/schemas/Uuid"
        milestones:
          type: array
          items:
            $ref: "#/components/schemas/Milestone"

    PagedUserVerification:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/UserVerification"
        page:
          $ref: "#/components/schemas/PageMeta"

    PayoutCondition:
      type: string
      enum: [TRANSFER_COMPLETED_CONFIRMED]

    TradeRulesConfig:
      type: object
      required:
        - version
        - depositRate
        - depositMinFen
        - depositMaxFen
        - depositFixedForNegotiableFen
        - autoRefundWindowMinutes
        - sellerMaterialDeadlineBusinessDays
        - contractSignedDeadlineBusinessDays
        - transferCompletedSlaDays
        - commissionRate
        - commissionMinFen
        - commissionMaxFen
        - payoutCondition
        - payoutMethodDefault
        - autoPayoutOnTimeout
      properties:
        version:
          type: integer
          minimum: 1
        depositRate:
          type: number
          format: double
          minimum: 0
          maximum: 1
          example: 0.05
        depositMinFen:
          $ref: "#/components/schemas/MoneyFen"
        depositMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        depositFixedForNegotiableFen:
          $ref: "#/components/schemas/MoneyFen"
        autoRefundWindowMinutes:
          type: integer
          minimum: 0
          example: 30
        sellerMaterialDeadlineBusinessDays:
          type: integer
          minimum: 1
          example: 3
        contractSignedDeadlineBusinessDays:
          type: integer
          minimum: 1
          example: 10
        transferCompletedSlaDays:
          type: integer
          minimum: 1
          example: 90
        commissionRate:
          type: number
          format: double
          minimum: 0
          maximum: 1
          example: 0.05
        commissionMinFen:
          $ref: "#/components/schemas/MoneyFen"
        commissionMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        payoutCondition:
          $ref: "#/components/schemas/PayoutCondition"
        payoutMethodDefault:
          $ref: "#/components/schemas/PayoutMethod"
        autoPayoutOnTimeout:
          type: boolean
          example: false

    RecommendationWeights:
      type: object
      required: [time, view, favorite, consult, region, user]
      example:
        time: 1
        view: 1
        favorite: 2
        consult: 3
        region: 2
        user: 1
      properties:
        time:
          type: number
          format: double
          minimum: 0
        view:
          type: number
          format: double
          minimum: 0
        favorite:
          type: number
          format: double
          minimum: 0
        consult:
          type: number
          format: double
          minimum: 0
        region:
          type: number
          format: double
          minimum: 0
        user:
          type: number
          format: double
          minimum: 0

    RecommendationFeaturedBoost:
      type: object
      required: [province, city]
      example:
        province: 2
        city: 3
      properties:
        province:
          type: number
          format: double
          minimum: 0
        city:
          type: number
          format: double
          minimum: 0

    RecommendationConfig:
      type: object
      required: [enabled, timeDecayHalfLifeHours, weights, featuredBoost, dedupeWindowHours]
      properties:
        enabled:
          type: boolean
        timeDecayHalfLifeHours:
          type: integer
          minimum: 1
          example: 72
        dedupeWindowHours:
          type: integer
          minimum: 0
          example: 24
        weights:
          $ref: "#/components/schemas/RecommendationWeights"
        featuredBoost:
          $ref: "#/components/schemas/RecommendationFeaturedBoost"
        updatedAt:
          type: string
          format: date-time

    RecommendationConfigUpdateRequest:
      type: object
      required: [enabled, timeDecayHalfLifeHours, weights, featuredBoost, dedupeWindowHours]
      properties:
        enabled:
          type: boolean
        timeDecayHalfLifeHours:
          type: integer
          minimum: 1
        dedupeWindowHours:
          type: integer
          minimum: 0
        weights:
          $ref: "#/components/schemas/RecommendationWeights"
        featuredBoost:
          $ref: "#/components/schemas/RecommendationFeaturedBoost"
        updatedAt:
          type: string
          format: date-time

    TradeRulesConfigUpdateRequest:
      type: object
      required:
        - depositRate
        - depositMinFen
        - depositMaxFen
        - depositFixedForNegotiableFen
        - autoRefundWindowMinutes
        - sellerMaterialDeadlineBusinessDays
        - contractSignedDeadlineBusinessDays
        - transferCompletedSlaDays
        - commissionRate
        - commissionMinFen
        - commissionMaxFen
        - payoutCondition
        - payoutMethodDefault
        - autoPayoutOnTimeout
      properties:
        depositRate:
          type: number
          format: double
          minimum: 0
          maximum: 1
        depositMinFen:
          $ref: "#/components/schemas/MoneyFen"
        depositMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        depositFixedForNegotiableFen:
          $ref: "#/components/schemas/MoneyFen"
        autoRefundWindowMinutes:
          type: integer
          minimum: 0
        sellerMaterialDeadlineBusinessDays:
          type: integer
          minimum: 1
        contractSignedDeadlineBusinessDays:
          type: integer
          minimum: 1
        transferCompletedSlaDays:
          type: integer
          minimum: 1
        commissionRate:
          type: number
          format: double
          minimum: 0
          maximum: 1
        commissionMinFen:
          $ref: "#/components/schemas/MoneyFen"
        commissionMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        payoutCondition:
          $ref: "#/components/schemas/PayoutCondition"
        payoutMethodDefault:
          $ref: "#/components/schemas/PayoutMethod"
        autoPayoutOnTimeout:
          type: boolean

    CustomerServiceAssignStrategy:
      type: string
      enum: [AUTO, MANUAL]
      description: 客服分配策略（演示用；真实生产可接入更复杂的分配/排班）

    CustomerServiceConfig:
      type: object
      required: [phone, defaultReply, assignStrategy]
      description: 客服配置（前台展示/后台配置）
      properties:
        phone:
          type: string
          example: "400-000-0000"
        defaultReply:
          type: string
          example: "您好，已收到您的咨询，客服将在 15 分钟内联系您。"
        assignStrategy:
          $ref: "#/components/schemas/CustomerServiceAssignStrategy"

    CustomerServiceConfigUpdateRequest:
      type: object
      required: [phone, defaultReply, assignStrategy]
      properties:
        phone:
          type: string
        defaultReply:
          type: string
        assignStrategy:
          $ref: "#/components/schemas/CustomerServiceAssignStrategy"

    RegionLevel:
      type: string
      enum: [PROVINCE, CITY, DISTRICT]
      description: 行政区划层级（P0 地图主要用 PROVINCE/CITY）

    RegionNode:
      type: object
      required: [code, name, level]
      properties:
        code:
          type: string
          pattern: "^[0-9]{6}$"
          description: 行政区划 adcode（6 位字符串）
          example: "110000"
        name:
          type: string
          description: 行政区划名称
          example: 北京市
        level:
          $ref: "#/components/schemas/RegionLevel"
        parentCode:
          type: string
          pattern: "^[0-9]{6}$"
          nullable: true
          description: 父级行政区划 adcode（6 位字符串）；省级为 null
        centerLat:
          type: number
          format: double
          nullable: true
          description: 地图中心点纬度（用于地图 marker；建议使用 GCJ-02 坐标系；可为空）
          example: 39.9042
        centerLng:
          type: number
          format: double
          nullable: true
          description: 地图中心点经度（用于地图 marker；建议使用 GCJ-02 坐标系；可为空）
          example: 116.4074
        industryTags:
          type: array
          items:
            type: string
          description: 区域特色产业标签（用于推荐/搜索加权）
        updatedAt:
          type: string
          format: date-time

    RegionCreateRequest:
      type: object
      required: [code, name, level]
      properties:
        code:
          type: string
          pattern: "^[0-9]{6}$"
        name:
          type: string
        level:
          $ref: "#/components/schemas/RegionLevel"
        parentCode:
          type: string
          pattern: "^[0-9]{6}$"
          nullable: true
        centerLat:
          type: number
          format: double
          nullable: true
        centerLng:
          type: number
          format: double
          nullable: true

    RegionUpdateRequest:
      type: object
      properties:
        name:
          type: string
        level:
          $ref: "#/components/schemas/RegionLevel"
        parentCode:
          type: string
          pattern: "^[0-9]{6}$"
          nullable: true
        centerLat:
          type: number
          format: double
          nullable: true
        centerLng:
          type: number
          format: double
          nullable: true

    IndustryTag:
      type: object
      required: [id, name]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        name:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    IndustryTagCreateRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 50

    PatentMapIndustryCount:
      type: object
      required: [industryTag, count]
      properties:
        industryTag:
          type: string
        count:
          type: integer
          minimum: 0

    PatentMapTopAssignee:
      type: object
      required: [name, patentCount]
      properties:
        name:
          type: string
        patentCount:
          type: integer
          minimum: 0

    PatentMapSummaryItem:
      type: object
      required: [regionCode, regionName, patentCount]
      properties:
        regionCode:
          type: string
          pattern: "^[0-9]{6}$"
          description: 行政区划 adcode（6 位字符串）
          example: "110000"
        regionName:
          type: string
          description: 行政区划名称快照（用于直接展示）
          example: 北京市
        patentCount:
          type: integer
          minimum: 0
          description: 该区域该年份的专利数量（按 `level/parentCode` 聚合口径）
          example: 1234

    PatentMapRegionDetail:
      type: object
      required: [regionCode, regionName, year, patentCount, industryBreakdown, topAssignees]
      properties:
        regionCode:
          type: string
        regionName:
          type: string
        year:
          type: integer
        patentCount:
          type: integer
          minimum: 0
        industryBreakdown:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapIndustryCount"
        topAssignees:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapTopAssignee"
        updatedAt:
          type: string
          format: date-time

    PatentMapEntry:
      type: object
      required: [regionCode, year, patentCount, industryBreakdown, topAssignees]
      properties:
        regionCode:
          type: string
        year:
          type: integer
        patentCount:
          type: integer
          minimum: 0
        industryBreakdown:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapIndustryCount"
        topAssignees:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapTopAssignee"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PatentMapEntryUpsertRequest:
      type: object
      required: [patentCount]
      properties:
        patentCount:
          type: integer
          minimum: 0
        industryBreakdown:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapIndustryCount"
        topAssignees:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapTopAssignee"

    PatentMapImportError:
      type: object
      required: [rowNumber, message]
      properties:
        rowNumber:
          type: integer
          minimum: 1
        message:
          type: string

    PatentMapImportResult:
      type: object
      required: [dryRun, importedCount, updatedCount, errors]
      properties:
        dryRun:
          type: boolean
        importedCount:
          type: integer
          minimum: 0
        updatedCount:
          type: integer
          minimum: 0
        errors:
          type: array
          items:
            $ref: "#/components/schemas/PatentMapImportError"

    UserBrief:
      type: object
      required: [id]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        nickname:
          type: string
        avatarUrl:
          type: string
          format: uri
        role:
          $ref: "#/components/schemas/UserRole"
        verificationStatus:
          $ref: "#/components/schemas/VerificationStatus"
        verificationType:
          $ref: "#/components/schemas/VerificationType"
          nullable: true
        orgCategory:
          $ref: "#/components/schemas/SupplyType"

    CommentContentType:
      type: string
      enum: [LISTING, DEMAND, ACHIEVEMENT, ARTWORK]

    CommentStatus:
      type: string
      enum: [VISIBLE, HIDDEN, DELETED]

    Comment:
      type: object
      required: [id, contentType, contentId, user, text, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        contentType:
          $ref: "#/components/schemas/CommentContentType"
        contentId:
          $ref: "#/components/schemas/Uuid"
        parentCommentId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
          description: 为空表示根留言；非空表示回复某条留言
        status:
          $ref: "#/components/schemas/CommentStatus"
        user:
          $ref: "#/components/schemas/UserBrief"
        text:
          type: string
          minLength: 1
          maxLength: 1000
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
          nullable: true

    CommentThread:
      type: object
      required: [root, replies]
      properties:
        root:
          $ref: "#/components/schemas/Comment"
        replies:
          type: array
          items:
            $ref: "#/components/schemas/Comment"

    PagedCommentThread:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/CommentThread"
        page:
          $ref: "#/components/schemas/PageMeta"

    CommentCreateRequest:
      type: object
      required: [text]
      properties:
        text:
          type: string
          minLength: 1
          maxLength: 1000
        parentCommentId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
          description: 回复目标留言 ID（为空表示发起新留言）

    CommentUpdateRequest:
      type: object
      required: [text]
      properties:
        text:
          type: string
          minLength: 1
          maxLength: 1000

    AdminCommentUpdateRequest:
      type: object
      required: [status]
      properties:
        status:
          $ref: "#/components/schemas/CommentStatus"

    PagedComment:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Comment"
        page:
          $ref: "#/components/schemas/PageMeta"

    ConversationContentType:
      type: string
      enum: [LISTING, DEMAND, ACHIEVEMENT, ARTWORK, TECH_MANAGER]

    Conversation:
      type: object
      required: [id, contentType, contentId, buyerUserId, sellerUserId, createdAt, updatedAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        contentType:
          $ref: "#/components/schemas/ConversationContentType"
        contentId:
          $ref: "#/components/schemas/Uuid"
        contentTitle:
          type: string
        listingId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
          deprecated: true
        listingTitle:
          type: string
          deprecated: true
        orderId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        buyerUserId:
          $ref: "#/components/schemas/Uuid"
        sellerUserId:
          $ref: "#/components/schemas/Uuid"
        lastMessageAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ConversationSummary:
      type: object
      required: [id, contentType, contentId, contentTitle, lastMessageAt, unreadCount, counterpart]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        contentType:
          $ref: "#/components/schemas/ConversationContentType"
        contentId:
          $ref: "#/components/schemas/Uuid"
        contentTitle:
          type: string
        listingId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
          deprecated: true
        listingTitle:
          type: string
          deprecated: true
        lastMessagePreview:
          type: string
        lastMessageAt:
          type: string
          format: date-time
        unreadCount:
          type: integer
          minimum: 0
        counterpart:
          $ref: "#/components/schemas/UserBrief"

    PagedConversationSummary:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/ConversationSummary"
        page:
          $ref: "#/components/schemas/PageMeta"

    ConversationMessageType:
      type: string
      description: 客户端仅允许发送 TEXT/EMOJI；SYSTEM 为系统消息
      enum: [TEXT, EMOJI, SYSTEM]

    ConversationMessage:
      type: object
      required: [id, conversationId, senderUserId, type, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        conversationId:
          $ref: "#/components/schemas/Uuid"
        senderUserId:
          $ref: "#/components/schemas/Uuid"
        type:
          $ref: "#/components/schemas/ConversationMessageType"
        text:
          type: string
          description: 文本/表情内容
        fileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
          deprecated: true
          description: P1 预留（附件消息未开放）
        fileUrl:
          type: string
          format: uri
          nullable: true
          deprecated: true
          description: P1 预留（附件消息未开放）
        createdAt:
          type: string
          format: date-time

    ConversationMessageSendRequest:
      type: object
      required: [type, text]
      properties:
        type:
          $ref: "#/components/schemas/ConversationMessageType"
        text:
          type: string
          description: type=TEXT/EMOJI 时必填

    PagedConversationMessage:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/ConversationMessage"
        nextCursor:
          type: string
          nullable: true

    AiAgentInputType:
      type: string
      enum: [TEXT, VOICE]

    AiContentScope:
      type: string
      enum: [LISTING, DEMAND, ACHIEVEMENT, ARTWORK, ALL]

    AiContentType:
      type: string
      enum: [LISTING, DEMAND, ACHIEVEMENT, ARTWORK]

    AiParseStatus:
      type: string
      enum: [ACTIVE, REVIEW_REQUIRED, REPLACED]

    AiParseFeedbackActorType:
      type: string
      enum: [USER, ADMIN]

    AiAgentQueryRequest:
      type: object
      required: [inputType]
      properties:
        inputType:
          $ref: "#/components/schemas/AiAgentInputType"
        inputText:
          type: string
          maxLength: 2000
        audioFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        contentScope:
          $ref: "#/components/schemas/AiContentScope"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        extraContext:
          type: object
          additionalProperties: true

    AiSearchFilters:
      type: object
      properties:
        q:
          type: string
        patentType:
          $ref: "#/components/schemas/PatentType"
        tradeMode:
          $ref: "#/components/schemas/TradeMode"
        priceType:
          $ref: "#/components/schemas/PriceType"
        priceMinFen:
          $ref: "#/components/schemas/MoneyFen"
        priceMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        depositMinFen:
          $ref: "#/components/schemas/MoneyFen"
        depositMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        regionCode:
          type: string
        industryTags:
          type: array
          items:
            type: string
        cooperationModes:
          type: array
          items:
            $ref: "#/components/schemas/CooperationMode"
        budgetType:
          $ref: "#/components/schemas/PriceType"
        budgetMinFen:
          $ref: "#/components/schemas/MoneyFen"
        budgetMaxFen:
          $ref: "#/components/schemas/MoneyFen"
        maturity:
          $ref: "#/components/schemas/AchievementMaturity"
        category:
          $ref: "#/components/schemas/ArtworkCategory"
        calligraphyScript:
          $ref: "#/components/schemas/CalligraphyScript"
        paintingGenre:
          $ref: "#/components/schemas/PaintingGenre"
        creator:
          type: string
        creationYearStart:
          type: integer
          minimum: 0
        creationYearEnd:
          type: integer
          minimum: 0

    AiAgentParsedQuery:
      type: object
      properties:
        contentType:
          $ref: "#/components/schemas/AiContentType"
        keywords:
          type: array
          items:
            type: string
        applicationScenario:
          type: string
        filters:
          $ref: "#/components/schemas/AiSearchFilters"

    AiAgentMatchSummary:
      type: object
      required: [contentType, contentId, title]
      properties:
        contentType:
          $ref: "#/components/schemas/AiContentType"
        contentId:
          $ref: "#/components/schemas/Uuid"
        title:
          type: string
        reason:
          type: string
        score:
          type: number
          format: double

    AiAgentQueryResult:
      type: object
      required: [queryId, parsedQuery]
      properties:
        queryId:
          $ref: "#/components/schemas/Uuid"
        recognizedText:
          type: string
        normalizedText:
          type: string
        contentScope:
          $ref: "#/components/schemas/AiContentScope"
        parsedQuery:
          $ref: "#/components/schemas/AiAgentParsedQuery"
        matchSummary:
          type: string
        topMatches:
          type: array
          items:
            $ref: "#/components/schemas/AiAgentMatchSummary"
        confidence:
          type: number
          format: double
        createdAt:
          type: string
          format: date-time

    AiParseResult:
      type: object
      required: [id, contentType, contentId, status, confidence, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        contentType:
          $ref: "#/components/schemas/AiContentType"
        contentId:
          $ref: "#/components/schemas/Uuid"
        summaryPlain:
          type: string
        featuresPlain:
          type: string
        keywords:
          type: array
          items:
            type: string
        confidence:
          type: number
          format: double
        modelVersion:
          type: string
        status:
          $ref: "#/components/schemas/AiParseStatus"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    AiParseFeedback:
      type: object
      required: [id, parseResultId, actorType, score, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        parseResultId:
          $ref: "#/components/schemas/Uuid"
        actorUserId:
          $ref: "#/components/schemas/Uuid"
        actorType:
          $ref: "#/components/schemas/AiParseFeedbackActorType"
        score:
          type: integer
          minimum: 1
          maximum: 5
        reasonTags:
          type: array
          items:
            type: string
        comment:
          type: string
          maxLength: 500
        createdAt:
          type: string
          format: date-time

    AiParseFeedbackRequest:
      type: object
      required: [score]
      properties:
        score:
          type: integer
          minimum: 1
          maximum: 5
        reasonTags:
          type: array
          items:
            type: string
        comment:
          type: string
          maxLength: 500

    AiParseResultUpdateRequest:
      type: object
      properties:
        summaryPlain:
          type: string
        featuresPlain:
          type: string
        keywords:
          type: array
          items:
            type: string
        status:
          $ref: "#/components/schemas/AiParseStatus"
        note:
          type: string
          maxLength: 500

    PagedAiParseResult:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/AiParseResult"
        page:
          $ref: "#/components/schemas/PageMeta"

    AiConfig:
      type: object
      required: [enabled]
      properties:
        enabled:
          type: boolean
        voiceEnabled:
          type: boolean
        asrProvider:
          type: string
        llmProvider:
          type: string
        hotwords:
          type: array
          items:
            type: string
        agentModelVersion:
          type: string
        parseModelVersion:
          type: string
        confidenceThreshold:
          type: number
          format: double
        reviewThreshold:
          type: number
          format: double
        maxInputSeconds:
          type: integer
          minimum: 1

    AiConfigUpdateRequest:
      type: object
      properties:
        enabled:
          type: boolean
        voiceEnabled:
          type: boolean
        asrProvider:
          type: string
        llmProvider:
          type: string
        hotwords:
          type: array
          items:
            type: string
        agentModelVersion:
          type: string
        parseModelVersion:
          type: string
        confidenceThreshold:
          type: number
          format: double
        reviewThreshold:
          type: number
          format: double
        maxInputSeconds:
          type: integer
          minimum: 1

    AlertSeverity:
      type: string
      enum: [LOW, MEDIUM, HIGH]

    AlertChannel:
      type: string
      enum: [SMS, EMAIL, IN_APP]

    AlertStatus:
      type: string
      enum: [PENDING, SENT, ACKED, SUPPRESSED]

    AlertTargetType:
      type: string
      enum: [PATENT, ORDER, LISTING, DEMAND, ACHIEVEMENT, ARTWORK, AI_PARSE, IMPORT, PAYMENT, REFUND, SYSTEM]

    AlertRule:
      type: object
      required: [type, severity, channels, enabled]
      properties:
        type:
          type: string
        severity:
          $ref: "#/components/schemas/AlertSeverity"
        channels:
          type: array
          items:
            $ref: "#/components/schemas/AlertChannel"
        enabled:
          type: boolean
        threshold:
          type: number
          format: double
        cooldownMinutes:
          type: integer
          minimum: 0

    AlertConfig:
      type: object
      required: [enabled, rules]
      properties:
        enabled:
          type: boolean
        defaultChannels:
          type: array
          items:
            $ref: "#/components/schemas/AlertChannel"
        rules:
          type: array
          items:
            $ref: "#/components/schemas/AlertRule"

    AlertConfigUpdateRequest:
      type: object
      properties:
        enabled:
          type: boolean
        defaultChannels:
          type: array
          items:
            $ref: "#/components/schemas/AlertChannel"
        rules:
          type: array
          items:
            $ref: "#/components/schemas/AlertRule"

    AlertEvent:
      type: object
      required: [id, type, severity, channel, status, triggeredAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        type:
          type: string
        severity:
          $ref: "#/components/schemas/AlertSeverity"
        channel:
          $ref: "#/components/schemas/AlertChannel"
        status:
          $ref: "#/components/schemas/AlertStatus"
        targetType:
          $ref: "#/components/schemas/AlertTargetType"
        targetId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        message:
          type: string
        triggeredAt:
          type: string
          format: date-time
        sentAt:
          type: string
          format: date-time
          nullable: true

    PagedAlertEvent:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/AlertEvent"
        page:
          $ref: "#/components/schemas/PageMeta"

    PatentMaintenanceStatus:
      type: string
      enum: [DUE, PAID, OVERDUE, WAIVED]

    PatentMaintenanceTaskStatus:
      type: string
      enum: [OPEN, IN_PROGRESS, DONE, CANCELLED]

    PatentMaintenanceSchedule:
      type: object
      required: [id, patentId, yearNo, dueDate, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        patentId:
          $ref: "#/components/schemas/Uuid"
        yearNo:
          type: integer
          minimum: 1
        dueDate:
          type: string
          format: date
        gracePeriodEnd:
          type: string
          format: date
          nullable: true
        status:
          $ref: "#/components/schemas/PatentMaintenanceStatus"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PatentMaintenanceScheduleCreateRequest:
      type: object
      required: [patentId, yearNo, dueDate]
      properties:
        patentId:
          $ref: "#/components/schemas/Uuid"
        yearNo:
          type: integer
          minimum: 1
        dueDate:
          type: string
          format: date
        gracePeriodEnd:
          type: string
          format: date
        status:
          $ref: "#/components/schemas/PatentMaintenanceStatus"

    PatentMaintenanceScheduleUpdateRequest:
      type: object
      properties:
        dueDate:
          type: string
          format: date
        gracePeriodEnd:
          type: string
          format: date
        status:
          $ref: "#/components/schemas/PatentMaintenanceStatus"

    PatentMaintenanceTask:
      type: object
      required: [id, scheduleId, status, createdAt]
      properties:
        id:
          $ref: "#/components/schemas/Uuid"
        scheduleId:
          $ref: "#/components/schemas/Uuid"
        assignedCsUserId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        status:
          $ref: "#/components/schemas/PatentMaintenanceTaskStatus"
        note:
          type: string
        evidenceFileId:
          $ref: "#/components/schemas/Uuid"
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PatentMaintenanceTaskCreateRequest:
      type: object
      required: [scheduleId]
      properties:
        scheduleId:
          $ref: "#/components/schemas/Uuid"
        assignedCsUserId:
          $ref: "#/components/schemas/Uuid"
        note:
          type: string

    PatentMaintenanceTaskUpdateRequest:
      type: object
      properties:
        assignedCsUserId:
          $ref: "#/components/schemas/Uuid"
        status:
          $ref: "#/components/schemas/PatentMaintenanceTaskStatus"
        note:
          type: string
        evidenceFileId:
          $ref: "#/components/schemas/Uuid"

    PagedPatentMaintenanceSchedule:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/PatentMaintenanceSchedule"
        page:
          $ref: "#/components/schemas/PageMeta"

    PagedPatentMaintenanceTask:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/PatentMaintenanceTask"
        page:
          $ref: "#/components/schemas/PageMeta"

    PatentCreateRequest:
      type: object
      required: [applicationNoNorm, patentType, title]
      properties:
        jurisdiction:
          $ref: "#/components/schemas/Jurisdiction"
        applicationNoNorm:
          type: string
        applicationNoDisplay:
          type: string
        patentType:
          $ref: "#/components/schemas/PatentType"
        title:
          type: string
        abstract:
          type: string
        inventorNames:
          type: array
          items:
            type: string
        assigneeNames:
          type: array
          items:
            type: string
        applicantNames:
          type: array
          items:
            type: string
        filingDate:
          type: string
          format: date
        publicationDate:
          type: string
          format: date
        grantDate:
          type: string
          format: date
        legalStatus:
          $ref: "#/components/schemas/LegalStatus"
        sourcePrimary:
          type: string
          enum: [USER, ADMIN, PROVIDER]
        sourceUpdatedAt:
          type: string
          format: date-time

    PatentUpdateRequest:
      type: object
      properties:
        applicationNoDisplay:
          type: string
        patentType:
          $ref: "#/components/schemas/PatentType"
        title:
          type: string
        abstract:
          type: string
        inventorNames:
          type: array
          items:
            type: string
        assigneeNames:
          type: array
          items:
            type: string
        applicantNames:
          type: array
          items:
            type: string
        filingDate:
          type: string
          format: date
        publicationDate:
          type: string
          format: date
        grantDate:
          type: string
          format: date
        legalStatus:
          $ref: "#/components/schemas/LegalStatus"
        sourcePrimary:
          type: string
          enum: [USER, ADMIN, PROVIDER]
        sourceUpdatedAt:
          type: string
          format: date-time

    PagedPatent:
      type: object
      required: [items, page]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Patent"
        page:
          $ref: "#/components/schemas/PageMeta"

    AdminListingCreateRequest:
      allOf:
        - $ref: "#/components/schemas/ListingCreateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            sellerUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ListingStatus"

    AdminListingUpdateRequest:
      allOf:
        - $ref: "#/components/schemas/ListingUpdateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            sellerUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ListingStatus"

    AdminDemandCreateRequest:
      allOf:
        - $ref: "#/components/schemas/DemandCreateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            publisherUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ContentStatus"

    AdminDemandUpdateRequest:
      allOf:
        - $ref: "#/components/schemas/DemandUpdateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            publisherUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ContentStatus"

    AdminAchievementCreateRequest:
      allOf:
        - $ref: "#/components/schemas/AchievementCreateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            publisherUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ContentStatus"

    AdminAchievementUpdateRequest:
      allOf:
        - $ref: "#/components/schemas/AchievementUpdateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            publisherUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ContentStatus"

    AdminArtworkCreateRequest:
      allOf:
        - $ref: "#/components/schemas/ArtworkCreateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            sellerUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ArtworkStatus"

    AdminArtworkUpdateRequest:
      allOf:
        - $ref: "#/components/schemas/ArtworkUpdateRequest"
        - type: object
          properties:
            source:
              $ref: "#/components/schemas/ContentSource"
            sellerUserId:
              $ref: "#/components/schemas/Uuid"
            auditStatus:
              $ref: "#/components/schemas/AuditStatus"
            status:
              $ref: "#/components/schemas/ArtworkStatus"
