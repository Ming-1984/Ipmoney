# 前端骨架演示（给甲方）：范围、状态机与 Mock 运行口径

> 目标：在后端未就绪时，用 OpenAPI + Mock 驱动把“小程序 + H5 + 后台”的页面骨架、交互与关键状态全部可演示；后端上线后仅替换数据源。

## 1. 多端策略（P0）

- **用户端**：Taro 一套代码编译 **微信小程序 + H5（电脑端可用）**
  - P0：H5 只做浏览/咨询/收藏等；**下单/支付引导回小程序**（二维码/链接）。
- **管理后台**：React + Ant Design（PC Web）

## 2. 统一交互状态机（每页必须可演示）

每个页面都要具备并可通过 Mock 触发：

- `loading`：骨架屏（可用“金豆/挖矿进度条”做轻点缀）
- `empty`：空态引导（去搜索/去发布/去认证）
- `error`：明确错误提示 + 可重试（支付/退款/状态机冲突优先给可解释文案）
- `permission`：未登录/无权限 → 引导登录/提交认证
- `audit`：审核中/驳回（带原因）/通过（展示身份标签/机构入口）

## 3. 登录与身份选择（P0）

- **游客**：可搜索/看列表/看详情
- **强制登录**：收藏/咨询/下单/支付
- **首次进入**：必须选择身份注册（`PERSON/COMPANY/ACADEMY/GOVERNMENT/ASSOCIATION/TECH_MANAGER`）
  - `PERSON`：授权信息后直接注册成功
  - 其余：提交资料→后台审核→通过后可发布/交易；企业/科研院校默认进入“机构展示”

## 4. 用户端骨架范围（建议按 `docs/demo/pages/README.md` 实现）

骨架验收口径：页面可打开、可切换筛选/排序、可进入详情、可触发收藏/咨询/下单等操作入口，并能展示状态机（不要求真实支付/过户完成）。

## 5. 后台骨架范围（P0 必演示）

- 认证审核（企业/科研院校/政府/协会/技术经理人）：通过/驳回（带原因）
- 上架审核：通过/驳回、重复/冒用权属提示与处置入口
- 订单：订金→合同确认→尾款→变更完成→结算放款（最小闭环可演示）
- 退款：秒退窗口/人工审批/退款失败重试提示
- 放款：财务线下打款后上传/录入凭证（留痕）
- 发票：订单完成后，后台上传电子发票文件；前台订单页可下载
- 配置：交易规则（订金/退款窗口/佣金/放款条件）+ 推荐权重配置
- 地图 CMS：区域数据录入（专利数量/产业分布/重点单位）与前台展示联动

## 6. Mock 运行口径（契约 Mock + 场景 Mock）

详见：`docs/engineering/mocking.md`

- **契约 Mock**（快速联调）：Prism 直接从 `docs/api/openapi.yaml` 起服务
- **场景 Mock**（演示/回归）：fixtures 覆盖“退款失败/回调重放/无数据/未登录/审核中”等难场景

建议统一场景开关：
- Header：`X-Mock-Scenario: happy | empty_search | refund_failed | payment_callback_replay | audit_pending | unauthorized`

## 7. P1 预留（先占位，不做实现）

- **用户端（小程序优先）：** Home/Search 增加智能体入口（语音/文本）；H5 显示“去小程序体验语音搜索”提示。
- **详情页：** 专利/需求/成果详情预留 AI 解析卡片 + 评分/纠错入口。
- **后台：** 预留 AI 解析复核池、平台内容 CMS、专利托管任务看板、告警中心、数据地图扩展（技术经理人/科学家）。
